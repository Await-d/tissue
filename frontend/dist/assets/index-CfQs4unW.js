import{aq as u,D as e,ai as w,E as v,G as b,ar as I,as as M,az as O,aA as z,r as d,at as p,S as B,H as D,J as k,aB as P,T as j,aC as U,X as $,a9 as q,U as y,aD as G,ax as N}from"./index-D7_jgbed.js";import{V as T}from"./index-SMRBXPG1.js";function _(C){const{onFilter:a,actors:x=[],initialValues:h,...m}=C,[l]=u.useForm();async function i(){const t=await l.validateFields();a(t)}function f(){l.resetFields(),a({})}const c=x.map(t=>({label:`${t.name}(${t.count}部)`,value:t.name}));return e.jsx(w,{title:"影片过滤",...m,footer:e.jsxs(v,{children:[e.jsx(b,{onClick:f,children:"重 制"}),e.jsx(b,{type:"primary",onClick:i,children:"确 定"})]}),children:e.jsxs(u,{form:l,layout:"vertical",initialValues:h,children:[e.jsx(u.Item,{name:"title",label:"标题",children:e.jsx(I,{allowClear:!0})}),e.jsx(u.Item,{name:"actors",label:"演员",children:e.jsx(M.Group,{options:c})})]})})}const J=function(){var F;const{data:a=[],loading:x,run:h,refresh:m}=O(z),[l,i]=d.useState(),[f,c]=d.useState(!1),[t,E]=d.useState({}),S=d.useMemo(()=>{const s=[];return a.forEach(n=>{n.actors.forEach(r=>{const o=s.find(R=>R.name==r.name);o?o.count=o.count+1:(r.count=1,s.push(r))})}),s},[a]),g=d.useMemo(()=>a.filter(s=>{var n;return t.title&&!s.title.toUpperCase().includes(t.title.toUpperCase())?!1:(n=t.actors)!=null&&n.length?s.actors.map(r=>r.name).filter(r=>{var o;return(o=t.actors)==null?void 0:o.includes(r)}).length>0:!0}),[t,a]),V=!!t.title||!!((F=t.actors)!=null&&F.length);return x?e.jsx(p,{children:e.jsx(B,{active:!0})}):e.jsxs(D,{gutter:[15,15],children:[g.length>0?g.map(s=>e.jsx(k,{span:24,md:12,lg:6,children:e.jsx(p,{hoverable:!0,size:"small",cover:e.jsx(P,{src:s.cover}),onClick:()=>i(s.path),children:e.jsx(p.Meta,{title:s.title,description:e.jsx("div",{className:"overflow-x-scroll",style:{scrollbarWidth:"none"},children:e.jsxs(v,{size:[0,"small"],children:[s.is_zh&&e.jsx(j,{color:"blue",bordered:!1,children:"中文"}),s.is_uncensored&&e.jsx(j,{color:"green",bordered:!1,children:"无码"}),s.actors.map(n=>e.jsx(j,{color:"purple",bordered:!1,children:n.name},n))]})})})})},s.path)):e.jsx(k,{span:24,children:e.jsx(p,{title:"视频",children:e.jsx(U,{description:e.jsxs("span",{children:["无视频，",e.jsx($,{to:"/setting",hash:"video",children:"配置视频"})]})})})}),e.jsx(T,{title:"编辑",mode:"video",width:1100,path:l,open:!!l,onCancel:()=>i(void 0),onOk:()=>{i(void 0),m()}}),e.jsx(_,{open:f,actors:S,initialValues:t,onCancel:()=>c(!1),onFilter:s=>{E(s),c(!1)}}),e.jsx(e.Fragment,{children:q.createPortal(e.jsxs(e.Fragment,{children:[e.jsx(y,{icon:e.jsx(G,{}),onClick:()=>h(!0)}),e.jsx(y,{icon:e.jsx(N,{}),type:V?"primary":"default",onClick:()=>c(!0)})]}),document.getElementsByClassName("index-float-button-group")[0])})]})};export{J as component};
