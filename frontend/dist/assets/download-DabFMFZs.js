import{W as k,aN as f,as as l,aB as t,F as e,S as v,at as r,O as h,a$ as b,ba as w,bn as c}from"./index-mgZE0TJV.js";import{g as C,s as I,t as B}from"./setting-BEHE52yv.js";function T(){const s=k(),{message:a}=f.useApp(),[d]=l.useForm(),{loading:g}=t(C,{onSuccess:o=>{d.setFieldsValue(o.download)}}),{run:p,loading:u}=t(I,{manual:!0,onSuccess:()=>{a.success("设置成功")}}),{run:j,loading:y}=t(B,{manual:!0,onSuccess:o=>{var n,i,m,x;console.log("测试连接响应:",o),(i=(n=o.data)==null?void 0:n.data)!=null&&i.status?a.success(o.data.data.message):(m=o.data)!=null&&m.status?a.success(o.data.message):((x=o.data)==null?void 0:x.success)===!1?a.error(o.data.details||"连接失败"):a.error("连接测试失败，请检查设置")},onError:o=>{console.error("测试连接错误:",o),a.error("测试连接失败："+(o.message||"未知错误"))}});function N(o){p("download",o)}return g?e.jsx(v,{active:!0}):e.jsx("div",{className:"max-w-5xl mx-auto px-6 py-8",children:e.jsxs("div",{style:{background:s.cardBg,borderColor:s.border},className:"rounded-2xl border shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"px-8 py-6 border-b",style:{borderColor:s.border,background:`linear-gradient(to right, ${s.bgDark}, ${s.cardBg})`},children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-3",style:{color:s.gold},children:[e.jsx("span",{className:"w-1.5 h-8 rounded-full",style:{background:`linear-gradient(to bottom, ${s.gold}, ${s.goldDark})`}}),"下载设置"]}),e.jsx("p",{className:"text-sm mt-2 ml-6",style:{color:s.textMuted},children:"配置 qBittorrent 下载器连接和自动化选项"})]}),e.jsx("div",{className:"p-8",children:e.jsxs(l,{layout:"vertical",form:d,onFinish:N,children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",style:{color:s.goldLight},children:[e.jsx("span",{className:"w-1 h-5 rounded-full",style:{background:s.gold}}),"连接配置"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"地址(qBittorrent)"}),name:"host",children:e.jsx(r,{style:{background:s.bgDark,borderColor:s.border,color:s.text},className:"hover:border-opacity-50 focus:shadow-sm",placeholder:"http://localhost:8080"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"用户名"}),name:"username",children:e.jsx(r,{autoComplete:"username",style:{background:s.bgDark,borderColor:s.border,color:s.text},className:"hover:border-opacity-50 focus:shadow-sm",placeholder:"admin"})}),e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"密码"}),name:"password",children:e.jsx(r.Password,{autoComplete:"new-password",style:{background:s.bgDark,borderColor:s.border,color:s.text},className:"hover:border-opacity-50 focus:shadow-sm"})})]}),e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"连接测试"}),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{loading:y,onClick:()=>j(),style:{background:s.sidebarBg,borderColor:s.border,color:s.gold},className:"hover:border-opacity-80",children:"测试连接"}),e.jsx("span",{className:"text-sm",style:{color:s.textSecondary},children:"保存设置后再测试连接"})]})})]})]}),e.jsxs("div",{className:"mb-8 pt-8 border-t",style:{borderColor:s.border},children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",style:{color:s.goldLight},children:[e.jsx("span",{className:"w-1 h-5 rounded-full",style:{background:s.gold}}),"路径配置"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"转移模式"}),name:"trans_mode",tooltip:"手动或自动转移使用的转移模式",children:e.jsx(b,{className:"custom-select-dark",children:w.map(o=>e.jsx(b.Option,{children:o.name},o.value))})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"下载路径"}),name:"download_path",tooltip:"将下载路径对应到系统路径，解决下载器和系统下载路径不一致的问题",children:e.jsx(r,{style:{background:s.bgDark,borderColor:s.border,color:s.text},className:"hover:border-opacity-50 focus:shadow-sm",placeholder:"/downloads"})}),e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"对应路径"}),name:"mapping_path",children:e.jsx(r,{style:{background:s.bgDark,borderColor:s.border,color:s.text},className:"hover:border-opacity-50 focus:shadow-sm",placeholder:"/mnt/downloads"})})]}),e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"默认保存路径"}),name:"savepath",tooltip:"设置qBittorrent默认保存路径，留空则使用qBittorrent默认设置",children:e.jsx(r,{placeholder:"例如：/downloads/av",style:{background:s.bgDark,borderColor:s.border,color:s.text},className:"hover:border-opacity-50 focus:shadow-sm"})})]})]}),e.jsxs("div",{className:"mb-8 pt-8 border-t",style:{borderColor:s.border},children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",style:{color:s.goldLight},children:[e.jsx("span",{className:"w-1 h-5 rounded-full",style:{background:s.gold}}),"自动化选项"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"自动转移(Beta)"}),name:"trans_auto",valuePropName:"checked",tooltip:"下载完成后是否自动转移到影片任务",className:"mb-0",children:e.jsx(c,{className:"custom-switch-gold"})}),e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"自动删种(Beta)"}),name:"delete_auto",valuePropName:"checked",tooltip:"整理完成后自动删除种子及数据",className:"mb-0",children:e.jsx(c,{className:"custom-switch-gold"})}),e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"完成后停止做种"}),name:"stop_seeding",valuePropName:"checked",tooltip:"种子下载完成并整理成功后自动停止做种，默认开启",className:"mb-0",children:e.jsx(c,{className:"custom-switch-gold"})})]})]}),e.jsxs("div",{className:"mb-8 pt-8 border-t",style:{borderColor:s.border},children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",style:{color:s.goldLight},children:[e.jsx("span",{className:"w-1 h-5 rounded-full",style:{background:s.gold}}),"高级选项"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"任务分类"}),name:"category",tooltip:"只有指定类别的任务会被识别，留空则为所有任务",children:e.jsx(r,{placeholder:"留空则为所有任务",style:{background:s.bgDark,borderColor:s.border,color:s.text},className:"hover:border-opacity-50 focus:shadow-sm"})}),e.jsx(l.Item,{label:e.jsx("span",{style:{color:s.text},children:"订阅Tracker"}),name:"tracker_subscribe",tooltip:e.jsxs("span",{children:["通过Tracker订阅链接，自动为任务添加Tracker列表。",e.jsx("a",{target:"_blank",href:"https://trackerslist.com/",style:{color:s.gold},className:"hover:opacity-80",children:"示例"})]}),children:e.jsx(r,{placeholder:"请输入Tracker订阅链接",style:{background:s.bgDark,borderColor:s.border,color:s.text},className:"hover:border-opacity-50 focus:shadow-sm"})})]})]}),e.jsx("div",{className:"flex justify-center pt-6",children:e.jsx(h,{type:"primary",size:"large",loading:u,htmlType:"submit",style:{background:`linear-gradient(to right, ${s.gold}, ${s.goldDark})`,border:0,color:s.buttonText,fontWeight:600},className:"w-48 h-11 shadow-lg hover:shadow-xl",children:"保存设置"})})]})})]})})}export{T as component};
