import{W as R,as as t,r as $,F as e,am as V,U as D,bx as I,by as N,al as L,at as x,O as h,ag as F,T as C,bb as M,aP as _,aN as q,aB as S,bz as U,bA as Y,bB as G,bC as H,bD as J,a6 as K,R as z,G as l,bE as O,bF as Q,a$ as X,au as T,b3 as Z,b2 as ee}from"./index-DT2mcGVD.js";const ae="_form_cf9pa_3",re="_container_cf9pa_8",te="_coverSection_cf9pa_24",ne="_posterContainer_cf9pa_40",oe="_infoSection_cf9pa_73",ie="_infoCard_cf9pa_89",se="_ratingInput_cf9pa_214",le="_actorsContainer_cf9pa_239",de="_websiteContainer_cf9pa_260",u={form:ae,container:re,coverSection:te,posterContainer:ne,infoSection:oe,infoCard:ie,ratingInput:se,actorsContainer:le,websiteContainer:de};function ce(j){const{data:r,onOk:i,onDelete:n,onCancel:g,...b}=j,a=R(),[s]=t.useForm(),[c,f]=$.useState(r==null?void 0:r.thumb);$.useEffect(()=>{j.open?(s.setFieldsValue(r),f(r==null?void 0:r.thumb)):(s.resetFields(),f(void 0))},[j.open,r]);function o(y){i==null||i(y)}const m=y=>{const w=y.target.value;f(w)},k=()=>{F.error("头像链接无效，请检查URL是否正确")},d={modal:{".ant-modal-mask":{background:a.modalOverlay},".ant-modal-content":{background:a.modalBg,border:`1px solid ${a.rgba("white",.08)}`,boxShadow:`0 24px 48px ${a.rgba("black",.8)}, 0 0 0 1px ${a.rgba("gold",.1)}`,backdropFilter:"blur(20px)",borderRadius:"16px"},".ant-modal-header":{background:"transparent",borderBottom:`1px solid ${a.rgba("white",.08)}`,padding:"20px 24px"},".ant-modal-title":{color:a.text,fontSize:"18px",fontWeight:"600",letterSpacing:"0.5px"},".ant-modal-close":{color:a.secondaryText,transition:"all 0.3s ease"},".ant-modal-close:hover":{color:a.gold},".ant-modal-body":{padding:"24px"},".ant-modal-footer":{borderTop:`1px solid ${a.rgba("white",.08)}`,padding:"16px 24px",background:a.rgba("black",.5)}},avatarContainer:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:32,padding:"24px 0",background:`linear-gradient(135deg, ${a.rgba("gold",.05)} 0%, transparent 100%)`,borderRadius:"12px",border:`1px solid ${a.rgba("white",.04)}`,transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)"},avatarWrapper:{position:"relative",transition:"transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)"},avatar:{border:`3px solid ${a.rgba("gold",.3)}`,boxShadow:`
                0 0 0 4px ${a.rgba("gold",.1)},
                0 0 24px ${a.rgba("gold",.3)},
                0 8px 32px ${a.rgba("black",.6)}
            `,transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",background:`linear-gradient(135deg, ${a.bgDark} 0%, ${a.bgDarker} 100%)`},avatarIcon:{color:a.gold},avatarLabel:{fontSize:13,color:a.tertiaryText,marginTop:12,letterSpacing:"0.3px",transition:"color 0.3s ease"},input:{background:a.rgba("black",.6),border:`1px solid ${a.rgba("white",.08)}`,color:a.text,borderRadius:"8px",padding:"10px 14px",fontSize:"14px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},buttonDelete:{background:a.rgba("red",.1),border:`1px solid ${a.rgba("red",.3)}`,color:a.red,borderRadius:"8px",height:"38px",padding:"0 20px",fontWeight:"500",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},buttonCancel:{background:a.rgba("white",.1),border:`1px solid ${a.rgba("white",.08)}`,color:a.secondaryText,borderRadius:"8px",height:"38px",padding:"0 20px",fontWeight:"500",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},buttonPrimary:{background:`linear-gradient(135deg, ${a.gold} 0%, ${a.goldAlt} 100%)`,border:"none",color:a.background,borderRadius:"8px",height:"38px",padding:"0 24px",fontWeight:"600",boxShadow:`0 4px 12px ${a.rgba("gold",.3)}`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"}};return e.jsxs(V,{title:r?"修改演员信息":"添加新演员",...b,width:480,forceRender:!0,onCancel:g,styles:d.modal,footer:[r&&e.jsx(h,{onClick:n,style:d.buttonDelete,className:"actor-modal-btn-delete",children:"删除"},"delete"),e.jsx(h,{onClick:g,style:d.buttonCancel,className:"actor-modal-btn-cancel",children:"取消"},"cancel"),e.jsx(h,{type:"primary",onClick:()=>s.submit(),style:d.buttonPrimary,className:"actor-modal-btn-primary",children:"确定"},"submit")],children:[e.jsx("style",{children:`
                    .actor-modal-btn-delete:hover {
                        background: ${a.rgba("red",.2)} !important;
                        border-color: ${a.rgba("red",.5)} !important;
                        color: ${a.redLight} !important;
                        transform: translateY(-1px);
                        box-shadow: 0 4px 12px ${a.rgba("red",.3)};
                    }

                    .actor-modal-btn-cancel:hover {
                        background: ${a.rgba("white",.15)} !important;
                        border-color: ${a.rgba("white",.12)} !important;
                        color: ${a.text} !important;
                        transform: translateY(-1px);
                    }

                    .actor-modal-btn-primary:hover {
                        background: linear-gradient(135deg, ${a.goldLight} 0%, ${a.gold} 100%) !important;
                        transform: translateY(-2px);
                        box-shadow: 0 8px 20px ${a.rgba("gold",.4)} !important;
                    }

                    .actor-avatar-wrapper:hover .ant-avatar {
                        transform: scale(1.05);
                        border-color: ${a.rgba("gold",.6)};
                        box-shadow:
                            0 0 0 4px ${a.rgba("gold",.2)},
                            0 0 32px ${a.rgba("gold",.5)},
                            0 12px 40px ${a.rgba("black",.7)};
                    }

                    .ant-input:hover,
                    .ant-input:focus {
                        background: ${a.rgba("black",.8)} !important;
                        border-color: ${a.rgba("gold",.4)} !important;
                        box-shadow: 0 0 0 2px ${a.rgba("gold",.1)} !important;
                    }

                    .ant-input::placeholder {
                        color: ${a.tertiaryText};
                    }

                    .ant-form-item-label > label.ant-form-item-required:not(.ant-form-item-required-mark-optional)::before {
                        color: ${a.gold} !important;
                    }

                    .ant-form-item-label > label {
                        color: ${a.secondaryText} !important;
                        font-size: 14px !important;
                        font-weight: 500 !important;
                        letter-spacing: 0.3px !important;
                    }

                    .ant-form-item-extra {
                        color: ${a.tertiaryText} !important;
                        font-size: 12px !important;
                    }
                `}),e.jsxs(t,{form:s,layout:"vertical",onFinish:o,initialValues:r,children:[e.jsxs(D,{direction:"vertical",style:d.avatarContainer,children:[e.jsx("div",{style:d.avatarWrapper,className:"actor-avatar-wrapper",children:e.jsx(I,{size:96,icon:e.jsx(L,{style:d.avatarIcon}),src:c&&N(c),onError:()=>(k(),!0),style:d.avatar})}),e.jsx("div",{style:d.avatarLabel,children:c?"预览头像":"暂无头像"})]}),e.jsx(t.Item,{name:"name",label:"演员姓名",rules:[{required:!0,message:"请输入演员姓名"}],children:e.jsx(x,{placeholder:"请输入演员姓名",style:d.input})}),e.jsx(t.Item,{name:"thumb",label:"头像链接",extra:"输入完整的图片URL或相对路径",children:e.jsx(x,{placeholder:"请输入头像链接",onChange:m,style:d.input})})]})]})}function pe(j){const{value:r,onChange:i}=j,n=R(),[g,b]=$.useState(void 0),[a,s]=$.useState(void 0);function c(o){if(g==="add"){if(r!=null&&r.some(m=>m.name===o.name))return F.error("该演员已存在");i==null||i([...r||[],o])}else g=="edit"&&(r[a]=o,i==null||i(r&&[...r]));b(void 0),s(void 0)}function f(){i==null||i(r==null?void 0:r.filter((o,m)=>m!=a)),b(void 0),s(void 0)}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(C.Title,{level:5,style:{marginBottom:12,color:n.text,fontSize:14,fontWeight:600,letterSpacing:"0.5px"},children:"演员信息"}),r&&r.length>0?e.jsx(D,{direction:"vertical",style:{width:"100%"},children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12},children:[r.map((o,m)=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},children:[e.jsx(I,{style:{cursor:"pointer",border:`2px solid ${n.rgba("gold",.5)}`,boxShadow:`0 4px 12px ${n.rgba("black",.4)}`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},size:64,src:(o==null?void 0:o.thumb)&&N(o.thumb),onClick:()=>{b("edit"),s(m)}}),e.jsx(C.Text,{style:{marginTop:8,maxWidth:64,textAlign:"center",fontSize:12,color:n.text,textShadow:`0 1px 2px ${n.rgba("black",.5)}`,fontWeight:500},ellipsis:{tooltip:o==null?void 0:o.name},children:o==null?void 0:o.name}),e.jsx(h,{size:"small",type:"text",icon:e.jsx(M,{}),style:{position:"absolute",top:-8,right:-8,background:`linear-gradient(135deg, ${n.goldAlt} 0%, ${n.gold} 100%)`,borderRadius:"50%",border:"none",padding:0,height:24,width:24,display:"flex",justifyContent:"center",alignItems:"center",color:n.background,boxShadow:`0 2px 8px ${n.rgba("gold",.4)}`,transition:"all 0.25s cubic-bezier(0.4, 0, 0.2, 1)"},onClick:()=>{b("edit"),s(m)}})]},o.name)),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(I,{style:{cursor:"pointer",backgroundColor:n.rgba("black",.6),border:`2px dashed ${n.rgba("gold",.3)}`,display:"flex",justifyContent:"center",alignItems:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",color:n.gold,boxShadow:`0 4px 12px ${n.rgba("black",.4)}`},size:64,icon:e.jsx(_,{}),onClick:()=>{b("add"),s(void 0)}}),e.jsx(C.Text,{style:{marginTop:8,fontSize:12,color:n.secondaryText,fontWeight:500},children:"添加演员"})]})]})}):e.jsx(h,{icon:e.jsx(_,{}),onClick:()=>{b("add"),s(void 0)},children:"添加演员"})]}),e.jsx(ce,{data:a!=null&&r&&r[a],open:!!g,onOk:c,onCancel:()=>b(void 0),onDelete:f})]})}function be(j){const{message:r,modal:i}=q.useApp(),{path:n,mode:g,transMode:b,onOk:a,...s}=j,[c]=t.useForm(),{run:f,loading:o}=S(A,{manual:!0,onSuccess:p=>{c.setFieldsValue(p)}}),{run:m,loading:k}=S(U,{manual:!0,onSuccess:p=>{const v={...p};delete v.is_zh,delete v.is_uncensored,c.setFieldsValue(v),r.success("刮削成功")}}),{run:d,loading:y}=S(Y,{manual:!0,onSuccess:()=>{r.success("保存成功"),a==null||a(void 0)}}),{run:w,loading:W}=S(G,{manual:!0,onSuccess:()=>{r.success("删除成功"),a==null||a(void 0)}});async function A(p){let v=await H(p);return v.num||(v=await J(p)),v}function E(){const p=c.getFieldValue("num");return p?m(p):r.error("请输入番号")}function P(p){return p.path=n,d(p,g,b)}function B(){i.confirm({title:"是否确认删除",onOk:()=>{w(n)}})}return $.useEffect(()=>{s.open&&n?f(n):c.resetFields()},[s.open]),e.jsx(V,{...s,forceRender:!0,width:1200,className:u.container,footer:[g==="video"&&e.jsxs(Z.Fragment,{children:[e.jsx(h,{onClick:B,danger:!0,loading:W,children:"删除"}),e.jsx(ee,{type:"vertical"})]},"delete"),e.jsx(h,{onClick:E,loading:k,children:"刮削"},"scrape"),e.jsx(h,{type:"primary",loading:y,onClick:()=>c.submit(),children:"确定"},"save")],children:e.jsx(K,{spinning:o,children:e.jsx(t,{className:u.form,form:c,layout:"vertical",onFinish:P,children:e.jsxs(z,{gutter:[30,15],children:[e.jsxs(l,{span:24,md:10,lg:10,className:u.coverSection,children:[e.jsx("div",{className:u.posterContainer,children:e.jsx(t.Item,{noStyle:!0,name:"cover",children:e.jsx(O,{})})}),e.jsx("br",{}),e.jsx("div",{className:u.actorsContainer,children:e.jsx(t.Item,{label:"演员",name:"actors",children:e.jsx(pe,{})})}),e.jsx("br",{}),e.jsx("div",{className:u.websiteContainer,children:e.jsx(t.Item,{label:"网站",name:"website",children:e.jsx(Q,{})})})]}),e.jsx(l,{span:24,md:14,lg:14,className:u.infoSection,children:e.jsx("div",{className:u.infoCard,children:e.jsxs(z,{gutter:[15,15],children:[e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"num",label:"番号",rules:[{required:!0,message:"请输入番号"}],children:e.jsx(x,{})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"premiered",label:"发行时间",children:e.jsx(x,{})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"rating",label:"评分",children:e.jsx("div",{className:u.ratingInput,children:e.jsx(x,{})})})}),e.jsx(l,{span:24,children:e.jsx(t.Item,{name:"title",label:"标题",children:e.jsx(x,{})})}),e.jsx(l,{span:24,children:e.jsx(t.Item,{name:"outline",label:"大纲",children:e.jsx(x.TextArea,{rows:4})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"studio",label:"制造商",children:e.jsx(x,{})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"publisher",label:"发行商",children:e.jsx(x,{})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"director",label:"导演",children:e.jsx(x,{})})}),e.jsx(l,{span:24,children:e.jsx(t.Item,{name:"tags",label:"类别",children:e.jsx(X,{mode:"tags"})})}),e.jsx(l,{span:12,children:e.jsx(t.Item,{name:"series",label:"系列",children:e.jsx(x,{})})}),e.jsx(l,{span:12,children:e.jsx(t.Item,{name:"runtime",label:"时长(分钟)",children:e.jsx(x,{})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"is_zh",label:"是否中文",valuePropName:"checked",initialValue:!1,children:e.jsx(T,{})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"is_uncensored",label:"是否无码",valuePropName:"checked",initialValue:!1,children:e.jsx(T,{})})})]})})})]})})})})}export{be as V};
