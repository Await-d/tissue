import{r as b,I as Ie,_ as J,b2 as R,b as fe,c as X,e as q,a as be,K as ge,d as Pe,C as ke,x as ye,bb as we,w as ze,p as Re,bc as Ne,D as Oe,v as Be,j as Me,m as Ee,k as W,bd as Ae,be as _e,l as Te,bf as Le,g as Ke,bg as De,bh as We,bi as ue,bj as He,A as xe,aM as ve,aN as Fe,a8 as Ge,W as Ve,$ as qe,aB as he,F as e,U as F,aU as Q,bk as Xe,a$ as Ue,bl as Je,aV as Ye,J as Z,al as Qe,N as te,M as pe,av as ee,R as oe,G as D,H as re,b1 as Ze,bm as me,a_ as K,O as ae,V as en,aD as ie,a0 as nn,am as tn,at as on,aq as rn,az as an,bn as sn,bo as ln,bp as cn}from"./index-g83hHc8K.js";import{u as dn}from"./index-CT0vXv0l.js";import{I as ne}from"./index-J3beOLvY.js";import{V as gn}from"./index-RfoxL_DF.js";import{R as un}from"./FolderViewOutlined-DzERkHho.js";var xn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm376 116c-119.3 0-216 96.7-216 216s96.7 216 216 216 216-96.7 216-216-96.7-216-216-216zm107.5 323.5C750.8 868.2 712.6 884 672 884s-78.8-15.8-107.5-44.5C535.8 810.8 520 772.6 520 732s15.8-78.8 44.5-107.5C593.2 595.8 631.4 580 672 580s78.8 15.8 107.5 44.5C808.2 653.2 824 691.4 824 732s-15.8 78.8-44.5 107.5zM761 656h-44.3c-2.6 0-5 1.2-6.5 3.3l-63.5 87.8-23.1-31.9a7.92 7.92 0 00-6.5-3.3H573c-6.5 0-10.3 7.4-6.5 12.7l73.8 102.1c3.2 4.4 9.7 4.4 12.9 0l114.2-158c3.9-5.3.1-12.7-6.4-12.7zM440 852H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"file-done",theme:"outlined"},hn=function(o,r){return b.createElement(Ie,J({},o,{ref:r,icon:xn}))},pn=b.forwardRef(hn),Ce=R.forwardRef(function(t,o){var r=t.prefixCls,n=t.forceRender,h=t.className,p=t.style,g=t.children,u=t.isActive,y=t.role,m=t.classNames,v=t.styles,S=R.useState(u||n),x=fe(S,2),i=x[0],c=x[1];return R.useEffect(function(){(n||u)&&c(!0)},[n,u]),i?R.createElement("div",{ref:o,className:X("".concat(r,"-content"),q(q({},"".concat(r,"-content-active"),u),"".concat(r,"-content-inactive"),!u),h),style:p,role:y},R.createElement("div",{className:X("".concat(r,"-content-box"),m==null?void 0:m.body),style:v==null?void 0:v.body},g)):null});Ce.displayName="PanelContent";var mn=["showArrow","headerClass","isActive","onItemClick","forceRender","className","classNames","styles","prefixCls","collapsible","accordion","panelKey","extra","header","expandIcon","openMotion","destroyInactivePanel","children"],je=R.forwardRef(function(t,o){var r=t.showArrow,n=r===void 0?!0:r,h=t.headerClass,p=t.isActive,g=t.onItemClick,u=t.forceRender,y=t.className,m=t.classNames,v=m===void 0?{}:m,S=t.styles,x=S===void 0?{}:S,i=t.prefixCls,c=t.collapsible,$=t.accordion,d=t.panelKey,f=t.extra,P=t.header,N=t.expandIcon,l=t.openMotion,O=t.destroyInactivePanel,C=t.children,B=be(t,mn),k=c==="disabled",M=f!=null&&typeof f!="boolean",E=q(q(q({onClick:function(){g==null||g(d)},onKeyDown:function(L){(L.key==="Enter"||L.keyCode===ge.ENTER||L.which===ge.ENTER)&&(g==null||g(d))},role:$?"tab":"button"},"aria-expanded",p),"aria-disabled",k),"tabIndex",k?-1:0),A=typeof N=="function"?N(t):R.createElement("i",{className:"arrow"}),_=A&&R.createElement("div",J({className:"".concat(i,"-expand-icon")},["header","icon"].includes(c)?E:{}),A),Y=X("".concat(i,"-item"),q(q({},"".concat(i,"-item-active"),p),"".concat(i,"-item-disabled"),k),y),G=X(h,"".concat(i,"-header"),q({},"".concat(i,"-collapsible-").concat(c),!!c),v.header),w=Pe({className:G,style:x.header},["header","icon"].includes(c)?{}:E);return R.createElement("div",J({},B,{ref:o,className:Y}),R.createElement("div",w,n&&_,R.createElement("span",J({className:"".concat(i,"-header-text")},c==="header"?E:{}),P),M&&R.createElement("div",{className:"".concat(i,"-extra")},f)),R.createElement(ke,J({visible:p,leavedClassName:"".concat(i,"-content-hidden")},l,{forceRender:u,removeOnLeave:O}),function(T,L){var U=T.className,V=T.style;return R.createElement(Ce,{ref:L,prefixCls:i,className:U,classNames:v,style:V,styles:x,isActive:p,forceRender:u,role:$?"tabpanel":void 0},C)}))}),fn=["children","label","key","collapsible","onItemClick","destroyInactivePanel"],bn=function(o,r){var n=r.prefixCls,h=r.accordion,p=r.collapsible,g=r.destroyInactivePanel,u=r.onItemClick,y=r.activeKey,m=r.openMotion,v=r.expandIcon;return o.map(function(S,x){var i=S.children,c=S.label,$=S.key,d=S.collapsible,f=S.onItemClick,P=S.destroyInactivePanel,N=be(S,fn),l=String($??x),O=d??p,C=P??g,B=function(E){O!=="disabled"&&(u(E),f==null||f(E))},k=!1;return h?k=y[0]===l:k=y.indexOf(l)>-1,R.createElement(je,J({},N,{prefixCls:n,key:l,panelKey:l,isActive:k,accordion:h,openMotion:m,expandIcon:v,header:c,collapsible:O,onItemClick:B,destroyInactivePanel:C}),i)})},yn=function(o,r,n){if(!o)return null;var h=n.prefixCls,p=n.accordion,g=n.collapsible,u=n.destroyInactivePanel,y=n.onItemClick,m=n.activeKey,v=n.openMotion,S=n.expandIcon,x=o.key||String(r),i=o.props,c=i.header,$=i.headerClass,d=i.destroyInactivePanel,f=i.collapsible,P=i.onItemClick,N=!1;p?N=m[0]===x:N=m.indexOf(x)>-1;var l=f??g,O=function(k){l!=="disabled"&&(y(k),P==null||P(k))},C={key:x,panelKey:x,header:c,headerClass:$,isActive:N,prefixCls:h,destroyInactivePanel:d??u,openMotion:v,accordion:p,children:o.props.children,onItemClick:O,expandIcon:S,collapsible:l};return typeof o.type=="string"?o:(Object.keys(C).forEach(function(B){typeof C[B]>"u"&&delete C[B]}),R.cloneElement(o,C))};function vn(t,o,r){return Array.isArray(t)?bn(t,r):ye(o).map(function(n,h){return yn(n,h,r)})}function Cn(t){var o=t;if(!Array.isArray(o)){var r=Ne(o);o=r==="number"||r==="string"?[o]:[]}return o.map(function(n){return String(n)})}var jn=R.forwardRef(function(t,o){var r=t.prefixCls,n=r===void 0?"rc-collapse":r,h=t.destroyInactivePanel,p=h===void 0?!1:h,g=t.style,u=t.accordion,y=t.className,m=t.children,v=t.collapsible,S=t.openMotion,x=t.expandIcon,i=t.activeKey,c=t.defaultActiveKey,$=t.onChange,d=t.items,f=X(n,y),P=we([],{value:i,onChange:function(M){return $==null?void 0:$(M)},defaultValue:c,postState:Cn}),N=fe(P,2),l=N[0],O=N[1],C=function(M){return O(function(){if(u)return l[0]===M?[]:[M];var E=l.indexOf(M),A=E>-1;return A?l.filter(function(_){return _!==M}):[].concat(Oe(l),[M])})};ze(!m,"[rc-collapse] `children` will be removed in next major version. Please use `items` instead.");var B=vn(d,m,{prefixCls:n,accordion:u,openMotion:S,expandIcon:x,collapsible:v,destroyInactivePanel:p,onItemClick:C,activeKey:l});return R.createElement("div",J({ref:o,className:f,style:g,role:u?"tablist":void 0},Re(t,{aria:!0,data:!0})),B)});const ce=Object.assign(jn,{Panel:je});ce.Panel;const Sn=b.forwardRef((t,o)=>{const{getPrefixCls:r}=b.useContext(Be),{prefixCls:n,className:h,showArrow:p=!0}=t,g=r("collapse",n),u=X({[`${g}-no-arrow`]:!p},h);return b.createElement(ce.Panel,Object.assign({ref:o},t,{prefixCls:g,className:u}))}),$n=t=>{const{componentCls:o,contentBg:r,padding:n,headerBg:h,headerPadding:p,collapseHeaderPaddingSM:g,collapseHeaderPaddingLG:u,collapsePanelBorderRadius:y,lineWidth:m,lineType:v,colorBorder:S,colorText:x,colorTextHeading:i,colorTextDisabled:c,fontSizeLG:$,lineHeight:d,lineHeightLG:f,marginSM:P,paddingSM:N,paddingLG:l,paddingXS:O,motionDurationSlow:C,fontSizeIcon:B,contentPadding:k,fontHeight:M,fontHeightLG:E}=t,A=`${W(m)} ${v} ${S}`;return{[o]:Object.assign(Object.assign({},_e(t)),{backgroundColor:h,border:A,borderRadius:y,"&-rtl":{direction:"rtl"},[`& > ${o}-item`]:{borderBottom:A,"&:first-child":{[`
            &,
            & > ${o}-header`]:{borderRadius:`${W(y)} ${W(y)} 0 0`}},"&:last-child":{[`
            &,
            & > ${o}-header`]:{borderRadius:`0 0 ${W(y)} ${W(y)}`}},[`> ${o}-header`]:Object.assign(Object.assign({position:"relative",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",padding:p,color:i,lineHeight:d,cursor:"pointer",transition:`all ${C}, visibility 0s`},Te(t)),{[`> ${o}-header-text`]:{flex:"auto"},[`${o}-expand-icon`]:{height:M,display:"flex",alignItems:"center",paddingInlineEnd:P},[`${o}-arrow`]:Object.assign(Object.assign({},Le()),{fontSize:B,transition:`transform ${C}`,svg:{transition:`transform ${C}`}}),[`${o}-header-text`]:{marginInlineEnd:"auto"}}),[`${o}-collapsible-header`]:{cursor:"default",[`${o}-header-text`]:{flex:"none",cursor:"pointer"},[`${o}-expand-icon`]:{cursor:"pointer"}},[`${o}-collapsible-icon`]:{cursor:"unset",[`${o}-expand-icon`]:{cursor:"pointer"}}},[`${o}-content`]:{color:x,backgroundColor:r,borderTop:A,[`& > ${o}-content-box`]:{padding:k},"&-hidden":{display:"none"}},"&-small":{[`> ${o}-item`]:{[`> ${o}-header`]:{padding:g,paddingInlineStart:O,[`> ${o}-expand-icon`]:{marginInlineStart:t.calc(N).sub(O).equal()}},[`> ${o}-content > ${o}-content-box`]:{padding:N}}},"&-large":{[`> ${o}-item`]:{fontSize:$,lineHeight:f,[`> ${o}-header`]:{padding:u,paddingInlineStart:n,[`> ${o}-expand-icon`]:{height:E,marginInlineStart:t.calc(l).sub(n).equal()}},[`> ${o}-content > ${o}-content-box`]:{padding:l}}},[`${o}-item:last-child`]:{borderBottom:0,[`> ${o}-content`]:{borderRadius:`0 0 ${W(y)} ${W(y)}`}},[`& ${o}-item-disabled > ${o}-header`]:{"\n          &,\n          & > .arrow\n        ":{color:c,cursor:"not-allowed"}},[`&${o}-icon-position-end`]:{[`& > ${o}-item`]:{[`> ${o}-header`]:{[`${o}-expand-icon`]:{order:1,paddingInlineEnd:0,paddingInlineStart:P}}}}})}},In=t=>{const{componentCls:o}=t,r=`> ${o}-item > ${o}-header ${o}-arrow`;return{[`${o}-rtl`]:{[r]:{transform:"rotate(180deg)"}}}},Pn=t=>{const{componentCls:o,headerBg:r,borderlessContentPadding:n,borderlessContentBg:h,colorBorder:p}=t;return{[`${o}-borderless`]:{backgroundColor:r,border:0,[`> ${o}-item`]:{borderBottom:`1px solid ${p}`},[`
        > ${o}-item:last-child,
        > ${o}-item:last-child ${o}-header
      `]:{borderRadius:0},[`> ${o}-item:last-child`]:{borderBottom:0},[`> ${o}-item > ${o}-content`]:{backgroundColor:h,borderTop:0},[`> ${o}-item > ${o}-content > ${o}-content-box`]:{padding:n}}}},kn=t=>{const{componentCls:o,paddingSM:r}=t;return{[`${o}-ghost`]:{backgroundColor:"transparent",border:0,[`> ${o}-item`]:{borderBottom:0,[`> ${o}-content`]:{backgroundColor:"transparent",border:0,[`> ${o}-content-box`]:{paddingBlock:r}}}}}},wn=t=>({headerPadding:`${t.paddingSM}px ${t.padding}px`,headerBg:t.colorFillAlter,contentPadding:`${t.padding}px 16px`,contentBg:t.colorBgContainer,borderlessContentPadding:`${t.paddingXXS}px 16px ${t.padding}px`,borderlessContentBg:"transparent"}),zn=Me("Collapse",t=>{const o=Ee(t,{collapseHeaderPaddingSM:`${W(t.paddingXS)} ${W(t.paddingSM)}`,collapseHeaderPaddingLG:`${W(t.padding)} ${W(t.paddingLG)}`,collapsePanelBorderRadius:t.borderRadiusLG});return[$n(o),Pn(o),kn(o),In(o),Ae(o)]},wn),Rn=b.forwardRef((t,o)=>{const{getPrefixCls:r,direction:n,expandIcon:h,className:p,style:g}=Ke("collapse"),{prefixCls:u,className:y,rootClassName:m,style:v,bordered:S=!0,ghost:x,size:i,expandIconPosition:c="start",children:$,destroyInactivePanel:d,destroyOnHidden:f,expandIcon:P}=t,N=De(w=>{var T;return(T=i??w)!==null&&T!==void 0?T:"middle"}),l=r("collapse",u),O=r(),[C,B,k]=zn(l),M=b.useMemo(()=>c==="left"?"start":c==="right"?"end":c,[c]),E=P??h,A=b.useCallback((w={})=>{const T=typeof E=="function"?E(w):b.createElement(We,{rotate:w.isActive?n==="rtl"?-90:90:void 0,"aria-label":w.isActive?"expanded":"collapsed"});return ue(T,()=>{var L;return{className:X((L=T.props)===null||L===void 0?void 0:L.className,`${l}-arrow`)}})},[E,l,n]),_=X(`${l}-icon-position-${M}`,{[`${l}-borderless`]:!S,[`${l}-rtl`]:n==="rtl",[`${l}-ghost`]:!!x,[`${l}-${N}`]:N!=="middle"},p,y,m,B,k),Y=b.useMemo(()=>Object.assign(Object.assign({},He(O)),{motionAppear:!1,leavedClassName:`${l}-content-hidden`}),[O,l]),G=b.useMemo(()=>$?ye($).map((w,T)=>{var L,U;const V=w.props;if(V!=null&&V.disabled){const se=(L=w.key)!==null&&L!==void 0?L:String(T),le=Object.assign(Object.assign({},xe(w.props,["disabled"])),{key:se,collapsible:(U=V.collapsible)!==null&&U!==void 0?U:"disabled"});return ue(w,le)}return w}):null,[$]);return C(b.createElement(ce,Object.assign({ref:o,openMotion:Y},xe(t,["rootClassName"]),{expandIcon:A,prefixCls:l,className:_,style:Object.assign(Object.assign({},g),v),destroyInactivePanel:f??d}),G))}),Nn=Object.assign(Rn,{Panel:Sn});async function On(t){return(await ve.request({url:"/download/",method:"get",params:t})).data.data}function Bn(t){return ve.request({url:"/download/complete",method:"get",params:{torrent_hash:t}})}const{useToken:Mn}=Ge;function Kn(){var de;const{message:t,modal:o}=Fe.useApp(),{token:r}=Mn(),n=Ve(),h=qe(),[p,g]=b.useState(),[u,y]=b.useState(),m=dn(u,{wait:1e3}),[v,S]=b.useState(!0),[x,i]=b.useState(!0),[c,$]=b.useState(!1),[d,f]=b.useState({status:"all",sizeRange:[0,1e4],dateRange:null,sortBy:"date",sortOrder:"desc"}),[P,N]=b.useState({total:0,downloading:0,completed:0,failed:0,totalSize:"0 GB"}),[l,O]=b.useState(!1),[C,B]=b.useState(null),[k,M]=b.useState(""),[E,A]=b.useState(!1),{data:_=[],loading:Y,refresh:G}=he(()=>On({include_success:v,include_failed:x}),{refreshDeps:[v,x]}),w=b.useMemo(()=>{let s=_.filter(a=>{if(!(!m||a.name.indexOf(m)!=-1||a.files.some(z=>z.name.indexOf(m)!=-1||z.path.indexOf(m)!=-1)))return!1;const j=a.files.some(z=>z.progress>=1),H=a.files.some(z=>z.progress===0);return!(!v&&j&&!a.files.some(z=>z.progress<1)||!x&&H)});return c&&(s=s.filter(a=>{if(d.status!=="all"){const I=a.files.some(H=>H.progress>=1),j=a.files.some(H=>H.progress>0&&H.progress<1);if(d.status==="completed"&&!I||d.status==="downloading"&&!j)return!1}return!0})),s},[_,m,c,d,v,x]),{run:T}=he(Bn,{manual:!0,onSuccess:()=>{t.success("标记成功"),G()}}),L=async s=>{try{A(!0),M(s);const a=await ln(s);a.success?(B(a.data),O(!0)):t.error(a.message||"获取清理预览失败")}catch(a){t.error((a==null?void 0:a.message)||"获取清理预览失败")}finally{A(!1)}},U=async()=>{try{A(!0);const s=await cn(k,!1);s.success?(t.success("清理成功"),O(!1),B(null),G()):t.error(s.message||"清理失败")}catch(s){t.error((s==null?void 0:s.message)||"清理失败")}finally{A(!1)}},V=()=>{O(!1),B(null),M("")},se=s=>{if(s){const a=new URLSearchParams(window.location.search),I=a.get("source")||"javdb",j=a.get("url")||"";h({to:`/video/${s}`,search:{source:I,url:j}})}else t.info("无法识别番号，无法跳转到详情页面")},le=s=>{h({to:"/actor",search:{actorName:s}})},Se=w.map(s=>({key:s.hash,label:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[e.jsx("span",{style:{color:n.textPrimary,fontWeight:500,fontSize:"14px"},children:s.name}),e.jsx(F,{children:(()=>{const a=s.files.length,I=s.files.filter(z=>z.progress>=1).length,j=s.files.filter(z=>z.progress>0&&z.progress<1).length,H=s.files.reduce((z,$e)=>z+$e.progress,0)/a;return e.jsxs(e.Fragment,{children:[e.jsxs(te,{style:{background:I===a?"rgba(82, 196, 26, 0.2)":j>0?n.rgba("gold",.2):n.borderPrimary,borderColor:I===a?"#52c41a":j>0?n.goldPrimary:n.borderPrimary,color:I===a?"#52c41a":j>0?n.goldLight:n.textSecondary,fontWeight:500},children:[I,"/",a," 文件"]}),e.jsx(pe,{percent:Math.round(H*100),size:"small",style:{width:80},strokeColor:I===a?"#52c41a":{"0%":n.goldPrimary,"100%":n.goldLight},trailColor:"rgba(255, 255, 255, 0.08)"})]})})()})]}),children:e.jsx(Z,{itemLayout:"horizontal",dataSource:s.files,style:{background:n.bgBase,borderRadius:"8px",padding:"12px"},renderItem:(a,I)=>e.jsx(Z.Item,{style:{background:n.bgElevated,borderRadius:"8px",padding:"12px 16px",marginBottom:"8px",border:"1px solid rgba(255, 255, 255, 0.08)",transition:"all 0.3s ease"},onMouseEnter:j=>{j.currentTarget.style.borderColor=n.goldPrimary,j.currentTarget.style.background=n.bgContainer},onMouseLeave:j=>{j.currentTarget.style.borderColor=n.borderPrimary,j.currentTarget.style.background=n.bgElevated},actions:[e.jsx(Q,{title:"整理",children:e.jsx(ne,{onClick:()=>{g(a.path)},children:e.jsx(un,{style:{fontSize:r.sizeLG}})})})],children:e.jsx(Z.Item.Meta,{title:e.jsxs("span",{children:[a.num?e.jsx("a",{onClick:()=>se(a.num),style:{color:n.goldPrimary,fontWeight:500,transition:"color 0.3s ease"},onMouseEnter:j=>{j.currentTarget.style.color=n.goldLight},onMouseLeave:j=>{j.currentTarget.style.color=n.goldPrimary},children:a.name}):e.jsx("span",{style:{color:n.textPrimary,fontWeight:500},children:a.name}),e.jsx(te,{style:{marginLeft:5,background:"rgba(82, 196, 26, 0.2)",borderColor:"#52c41a",color:"#52c41a",fontWeight:500},children:a.size}),a.progress<1&&e.jsx(pe,{percent:Math.round(a.progress*100),size:"small",style:{width:100,marginLeft:10,display:"inline-block"},strokeColor:{"0%":n.goldPrimary,"100%":n.goldLight},trailColor:"rgba(255, 255, 255, 0.08)"})]}),description:e.jsxs("div",{children:[e.jsx("div",{style:{color:n.textTertiary,fontSize:"13px",marginTop:"4px"},children:a.path}),a.actors&&a.actors.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx(Qe,{style:{marginRight:6,color:n.textSecondary}}),a.actors.map((j,H)=>e.jsxs(R.Fragment,{children:[e.jsx("a",{onClick:()=>le(j),style:{color:n.goldPrimary,fontWeight:500,fontSize:"13px",transition:"color 0.3s ease"},onMouseEnter:z=>{z.currentTarget.style.color=n.goldLight},onMouseLeave:z=>{z.currentTarget.style.color=n.goldPrimary},children:j}),H<a.actors.length-1&&e.jsx("span",{children:", "})]},j))]})]})})})}),extra:e.jsxs(F,{children:[e.jsx(Q,{title:"清理文件",children:e.jsx(ne,{onClick:()=>L(s.hash),loading:E&&k===s.hash,children:e.jsx(Xe,{style:{fontSize:r.sizeLG,color:n.warning}})})}),e.jsx(Q,{title:"重新开始下载",children:e.jsx(ne,{onClick:()=>{t.info("重新开始下载功能开发中...")},children:e.jsx(Ue,{style:{fontSize:r.sizeLG,color:"#1890ff"}})})}),e.jsx(Q,{title:"暂停下载",children:e.jsx(ne,{onClick:()=>{t.info("暂停下载功能开发中...")},children:e.jsx(Je,{style:{fontSize:r.sizeLG,color:"#faad14"}})})}),e.jsx(Q,{title:'标记为"整理成功"',children:e.jsx(ne,{onClick:()=>{o.confirm({title:"是否确认标记为完成",onOk:()=>T(s.hash)})},children:e.jsx(pn,{style:{fontSize:r.sizeLG,color:"#52c41a"}})})}),e.jsx(Q,{title:"删除任务",children:e.jsx(ne,{onClick:()=>{o.confirm({title:"确认删除下载任务？",content:"此操作将删除下载任务，但不会删除已下载的文件",okText:"确认删除",okType:"danger",onOk:()=>{t.info("删除功能开发中...")}})},children:e.jsx(Ye,{style:{fontSize:r.sizeLG,color:"#ff4d4f"}})})})]})}));return e.jsxs(ee,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:n.textPrimary,fontSize:"18px",fontWeight:600},children:"下载列表"}),e.jsxs(F,{children:[e.jsxs(ae,{icon:e.jsx(an,{}),size:"small",onClick:()=>$(!c),style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textSecondary,transition:"all 0.3s ease"},children:["高级筛选 ",c?"▼":"▶"]}),e.jsx(ae,{icon:e.jsx(sn,{}),size:"small",onClick:G,loading:Y,style:{background:"linear-gradient(135deg, #d4a852 0%, #e8c780 100%)",borderColor:n.goldPrimary,color:n.bgBase,fontWeight:600,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:"刷新"})]})]}),loading:Y,extra:e.jsxs(F.Compact,{children:[e.jsx(on,{value:u,onChange:s=>y(s.target.value),placeholder:"搜索",style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textPrimary}}),e.jsx(ae,{icon:e.jsx(rn,{}),style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textSecondary}})]}),style:{background:n.bgElevated,borderColor:n.borderPrimary},styles:{header:{background:n.bgBase,borderBottom:"1px solid rgba(255, 255, 255, 0.08)"},body:{background:n.bgElevated}},children:[e.jsxs(oe,{gutter:16,style:{marginBottom:20},children:[e.jsx(D,{span:6,children:e.jsx(ee,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(re,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"总任务数"}),value:_.length,valueStyle:{color:n.textPrimary,fontSize:"24px",fontWeight:600}})})}),e.jsx(D,{span:6,children:e.jsx(ee,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(re,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"进行中"}),value:_.reduce((s,a)=>s+a.files.filter(I=>I.progress>0&&I.progress<1).length,0),valueStyle:{color:"#4facfe",fontSize:"24px",fontWeight:600}})})}),e.jsx(D,{span:6,children:e.jsx(ee,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(re,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"已完成"}),value:_.reduce((s,a)=>s+a.files.filter(I=>I.progress>=1).length,0),valueStyle:{color:"#52c41a",fontSize:"24px",fontWeight:600}})})}),e.jsx(D,{span:6,children:e.jsx(ee,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(re,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"失败/等待"}),value:_.reduce((s,a)=>s+a.files.filter(I=>I.progress===0).length,0),valueStyle:{color:"#ff7875",fontSize:"24px",fontWeight:600}})})})]}),e.jsx(Ze,{}),e.jsx("div",{style:{marginBottom:16,padding:"12px 16px",background:n.bgContainer,border:"1px solid rgba(255, 255, 255, 0.08)",borderRadius:"8px"},children:e.jsxs(oe,{gutter:16,children:[e.jsx(D,{children:e.jsxs(F,{children:[e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"显示已完成:"}),e.jsx(me,{checked:v,onChange:S,size:"small",style:{background:v?n.goldPrimary:"rgba(255, 255, 255, 0.2)"}})]})}),e.jsx(D,{children:e.jsxs(F,{children:[e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"显示失败:"}),e.jsx(me,{checked:x,onChange:i,size:"small",style:{background:x?n.goldPrimary:"rgba(255, 255, 255, 0.2)"}})]})})]})}),c&&e.jsx(ee,{size:"small",style:{marginBottom:16,background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px",background:n.bgContainer}},children:e.jsxs(oe,{gutter:[16,8],children:[e.jsxs(D,{span:8,children:[e.jsx("div",{style:{marginBottom:8,color:n.textSecondary,fontSize:"14px",fontWeight:500},children:"状态筛选"}),e.jsxs(K,{value:d.status,onChange:s=>f({...d,status:s}),style:{width:"100%"},dropdownStyle:{background:n.bgContainer,borderColor:n.borderPrimary},children:[e.jsx(K.Option,{value:"all",children:"全部状态"}),e.jsx(K.Option,{value:"downloading",children:"下载中"}),e.jsx(K.Option,{value:"completed",children:"已完成"}),e.jsx(K.Option,{value:"failed",children:"失败/等待"})]})]}),e.jsxs(D,{span:8,children:[e.jsx("div",{style:{marginBottom:8,color:n.textSecondary,fontSize:"14px",fontWeight:500},children:"排序方式"}),e.jsxs(K,{value:`${d.sortBy}-${d.sortOrder}`,onChange:s=>{const[a,I]=s.split("-");f({...d,sortBy:a,sortOrder:I})},style:{width:"100%"},dropdownStyle:{background:n.bgContainer,borderColor:n.borderPrimary},children:[e.jsx(K.Option,{value:"date-desc",children:"添加时间 (新→旧)"}),e.jsx(K.Option,{value:"date-asc",children:"添加时间 (旧→新)"}),e.jsx(K.Option,{value:"progress-desc",children:"进度 (高→低)"}),e.jsx(K.Option,{value:"progress-asc",children:"进度 (低→高)"}),e.jsx(K.Option,{value:"size-desc",children:"大小 (大→小)"}),e.jsx(K.Option,{value:"size-asc",children:"大小 (小→大)"})]})]}),e.jsxs(D,{span:8,children:[e.jsx("div",{style:{marginBottom:8,color:n.textSecondary,fontSize:"14px",fontWeight:500},children:"快速操作"}),e.jsx(F,{children:e.jsx(ae,{size:"small",onClick:()=>{f({status:"all",sizeRange:[0,1e4],dateRange:null,sortBy:"date",sortOrder:"desc"}),y("")},style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textSecondary},children:"重置筛选"})})]})]})}),w.length>0?e.jsxs(e.Fragment,{children:[w.length!==_.length&&e.jsx("div",{style:{marginBottom:16,padding:"12px 16px",background:n.bgContainer,border:"1px solid rgba(255, 255, 255, 0.08)",borderRadius:8},children:e.jsxs(F,{children:[e.jsx(en,{count:w.length,style:{background:"linear-gradient(135deg, #d4a852 0%, #e8c780 100%)",color:n.bgBase,fontWeight:600,boxShadow:"0 2px 8px rgba(212, 168, 82, 0.3)"}}),e.jsxs("span",{style:{color:n.textSecondary,fontSize:"14px"},children:["筛选结果：",w.length," / ",_.length," 个任务"]})]})}),e.jsx(Nn,{items:Se,ghost:!0})]}):_.length>0?e.jsx(ie,{description:"没有符合筛选条件的下载任务"}):e.jsx(ie,{description:e.jsxs("span",{children:["无下载任务，",e.jsx(nn,{to:"/setting/download",children:"配置下载"})]})}),e.jsx(gn,{title:"下载整理",mode:"download",width:1100,path:p,open:!!p,onCancel:()=>g(void 0),onOk:()=>{g(void 0),G()}}),e.jsx(tn,{title:"清理文件预览",open:l,onOk:U,onCancel:V,okText:"确认清理",cancelText:"取消",okButtonProps:{danger:!0,loading:E},width:800,styles:{body:{background:n.bgBase,maxHeight:"500px",overflowY:"auto"}},children:C&&e.jsxs("div",{style:{color:n.textPrimary},children:[e.jsx("div",{style:{marginBottom:16,padding:"12px 16px",background:n.bgContainer,borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:e.jsxs(oe,{gutter:16,children:[e.jsxs(D,{span:12,children:[e.jsx("span",{style:{color:n.textSecondary},children:"将要删除的文件数："}),e.jsx("span",{style:{color:"#ff4d4f",fontWeight:600,marginLeft:8},children:((de=C.files_to_delete)==null?void 0:de.length)||0})]}),e.jsxs(D,{span:12,children:[e.jsx("span",{style:{color:n.textSecondary},children:"预计释放空间："}),e.jsx("span",{style:{color:"#52c41a",fontWeight:600,marginLeft:8},children:C.total_size||"0 MB"})]})]})}),C.files_to_delete&&C.files_to_delete.length>0?e.jsx(Z,{dataSource:C.files_to_delete,renderItem:s=>e.jsx(Z.Item,{style:{background:n.bgElevated,borderRadius:"8px",padding:"12px 16px",marginBottom:"8px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:e.jsx(Z.Item.Meta,{title:e.jsx("span",{style:{color:n.textPrimary},children:s.name}),description:e.jsxs("div",{children:[e.jsx("div",{style:{color:n.textTertiary,fontSize:"13px"},children:s.path}),e.jsxs(F,{style:{marginTop:4},children:[e.jsx(te,{style:{background:"rgba(255, 77, 79, 0.2)",borderColor:"#ff4d4f",color:"#ff4d4f"},children:s.size}),s.reason&&e.jsx(te,{style:{background:"rgba(250, 173, 20, 0.2)",borderColor:n.warning,color:n.warning},children:s.reason})]})]})})})}):e.jsx(ie,{description:"没有需要清理的文件",style:{color:n.textSecondary}})]})})]})}export{Kn as component};
