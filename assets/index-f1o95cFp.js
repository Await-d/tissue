import{r as d,I as Te,_ as ne,b3 as z,b as Ce,c as U,e as X,a as je,K as ge,d as Le,C as We,x as Se,bc as Ke,w as De,p as He,bd as Fe,D as Ge,v as Ve,j as qe,m as Xe,k as F,be as Ue,bf as Ye,l as Je,bg as Qe,g as Ze,bh as en,bi as nn,bj as ue,bk as tn,A as xe,aM as $e,aN as an,a8 as on,W as rn,$ as sn,aB as he,F as e,U as V,aU as te,bl as pe,b0 as ln,bm as cn,aV as dn,J as q,al as gn,N as re,M as fe,av as ae,R as se,G as W,H as ee,b2 as un,bn as me,a$ as D,O as le,V as ye,aD as ie,a0 as xn,am as be,at as hn,aq as pn,az as fn,bo as mn,bp as yn,bq as bn,br as ve}from"./index-CyNTvvQc.js";import{u as vn}from"./index-BE610I5o.js";import{I as oe}from"./index-B8zg5PaH.js";import{V as Cn}from"./index-BYqfNQuA.js";import{R as jn}from"./FolderViewOutlined-XQeKHKZA.js";var Sn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm376 116c-119.3 0-216 96.7-216 216s96.7 216 216 216 216-96.7 216-216-96.7-216-216-216zm107.5 323.5C750.8 868.2 712.6 884 672 884s-78.8-15.8-107.5-44.5C535.8 810.8 520 772.6 520 732s15.8-78.8 44.5-107.5C593.2 595.8 631.4 580 672 580s78.8 15.8 107.5 44.5C808.2 653.2 824 691.4 824 732s-15.8 78.8-44.5 107.5zM761 656h-44.3c-2.6 0-5 1.2-6.5 3.3l-63.5 87.8-23.1-31.9a7.92 7.92 0 00-6.5-3.3H573c-6.5 0-10.3 7.4-6.5 12.7l73.8 102.1c3.2 4.4 9.7 4.4 12.9 0l114.2-158c3.9-5.3.1-12.7-6.4-12.7zM440 852H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"file-done",theme:"outlined"},$n=function(a,s){return d.createElement(Te,ne({},a,{ref:s,icon:Sn}))},In=d.forwardRef($n),Ie=z.forwardRef(function(t,a){var s=t.prefixCls,n=t.forceRender,f=t.className,m=t.style,u=t.children,x=t.isActive,v=t.role,y=t.classNames,C=t.styles,$=z.useState(x||n),h=Ce($,2),i=h[0],c=h[1];return z.useEffect(function(){(n||x)&&c(!0)},[n,x]),i?z.createElement("div",{ref:a,className:U("".concat(s,"-content"),X(X({},"".concat(s,"-content-active"),x),"".concat(s,"-content-inactive"),!x),f),style:m,role:v},z.createElement("div",{className:U("".concat(s,"-content-box"),y==null?void 0:y.body),style:C==null?void 0:C.body},u)):null});Ie.displayName="PanelContent";var kn=["showArrow","headerClass","isActive","onItemClick","forceRender","className","classNames","styles","prefixCls","collapsible","accordion","panelKey","extra","header","expandIcon","openMotion","destroyInactivePanel","children"],ke=z.forwardRef(function(t,a){var s=t.showArrow,n=s===void 0?!0:s,f=t.headerClass,m=t.isActive,u=t.onItemClick,x=t.forceRender,v=t.className,y=t.classNames,C=y===void 0?{}:y,$=t.styles,h=$===void 0?{}:$,i=t.prefixCls,c=t.collapsible,I=t.accordion,g=t.panelKey,b=t.extra,k=t.header,R=t.expandIcon,l=t.openMotion,B=t.destroyInactivePanel,j=t.children,M=je(t,kn),P=c==="disabled",O=b!=null&&typeof b!="boolean",_=X(X(X({onClick:function(){u==null||u(g)},onKeyDown:function(N){(N.key==="Enter"||N.keyCode===ge.ENTER||N.which===ge.ENTER)&&(u==null||u(g))},role:I?"tab":"button"},"aria-expanded",m),"aria-disabled",P),"tabIndex",P?-1:0),T=typeof R=="function"?R(t):z.createElement("i",{className:"arrow"}),Y=T&&z.createElement("div",ne({className:"".concat(i,"-expand-icon")},["header","icon"].includes(c)?_:{}),T),J=U("".concat(i,"-item"),X(X({},"".concat(i,"-item-active"),m),"".concat(i,"-item-disabled"),P),v),H=U(f,"".concat(i,"-header"),X({},"".concat(i,"-collapsible-").concat(c),!!c),C.header),E=Le({className:H,style:h.header},["header","icon"].includes(c)?{}:_);return z.createElement("div",ne({},M,{ref:a,className:J}),z.createElement("div",E,n&&Y,z.createElement("span",ne({className:"".concat(i,"-header-text")},c==="header"?_:{}),k),O&&z.createElement("div",{className:"".concat(i,"-extra")},b)),z.createElement(We,ne({visible:m,leavedClassName:"".concat(i,"-content-hidden")},l,{forceRender:x,removeOnLeave:B}),function(A,N){var L=A.className,G=A.style;return z.createElement(Ie,{ref:N,prefixCls:i,className:L,classNames:C,style:G,styles:h,isActive:m,forceRender:x,role:I?"tabpanel":void 0},j)}))}),Pn=["children","label","key","collapsible","onItemClick","destroyInactivePanel"],wn=function(a,s){var n=s.prefixCls,f=s.accordion,m=s.collapsible,u=s.destroyInactivePanel,x=s.onItemClick,v=s.activeKey,y=s.openMotion,C=s.expandIcon;return a.map(function($,h){var i=$.children,c=$.label,I=$.key,g=$.collapsible,b=$.onItemClick,k=$.destroyInactivePanel,R=je($,Pn),l=String(I??h),B=g??m,j=k??u,M=function(_){B!=="disabled"&&(x(_),b==null||b(_))},P=!1;return f?P=v[0]===l:P=v.indexOf(l)>-1,z.createElement(ke,ne({},R,{prefixCls:n,key:l,panelKey:l,isActive:P,accordion:f,openMotion:y,expandIcon:C,header:c,collapsible:B,onItemClick:M,destroyInactivePanel:j}),i)})},zn=function(a,s,n){if(!a)return null;var f=n.prefixCls,m=n.accordion,u=n.collapsible,x=n.destroyInactivePanel,v=n.onItemClick,y=n.activeKey,C=n.openMotion,$=n.expandIcon,h=a.key||String(s),i=a.props,c=i.header,I=i.headerClass,g=i.destroyInactivePanel,b=i.collapsible,k=i.onItemClick,R=!1;m?R=y[0]===h:R=y.indexOf(h)>-1;var l=b??u,B=function(P){l!=="disabled"&&(v(P),k==null||k(P))},j={key:h,panelKey:h,header:c,headerClass:I,isActive:R,prefixCls:f,destroyInactivePanel:g??x,openMotion:C,accordion:m,children:a.props.children,onItemClick:B,expandIcon:$,collapsible:l};return typeof a.type=="string"?a:(Object.keys(j).forEach(function(M){typeof j[M]>"u"&&delete j[M]}),z.cloneElement(a,j))};function Rn(t,a,s){return Array.isArray(t)?wn(t,s):Se(a).map(function(n,f){return zn(n,f,s)})}function Bn(t){var a=t;if(!Array.isArray(a)){var s=Fe(a);a=s==="number"||s==="string"?[a]:[]}return a.map(function(n){return String(n)})}var Nn=z.forwardRef(function(t,a){var s=t.prefixCls,n=s===void 0?"rc-collapse":s,f=t.destroyInactivePanel,m=f===void 0?!1:f,u=t.style,x=t.accordion,v=t.className,y=t.children,C=t.collapsible,$=t.openMotion,h=t.expandIcon,i=t.activeKey,c=t.defaultActiveKey,I=t.onChange,g=t.items,b=U(n,v),k=Ke([],{value:i,onChange:function(O){return I==null?void 0:I(O)},defaultValue:c,postState:Bn}),R=Ce(k,2),l=R[0],B=R[1],j=function(O){return B(function(){if(x)return l[0]===O?[]:[O];var _=l.indexOf(O),T=_>-1;return T?l.filter(function(Y){return Y!==O}):[].concat(Ge(l),[O])})};De(!y,"[rc-collapse] `children` will be removed in next major version. Please use `items` instead.");var M=Rn(g,y,{prefixCls:n,accordion:x,openMotion:$,expandIcon:h,collapsible:C,destroyInactivePanel:m,onItemClick:j,activeKey:l});return z.createElement("div",ne({ref:a,className:b,style:u,role:x?"tablist":void 0},He(t,{aria:!0,data:!0})),M)});const ce=Object.assign(Nn,{Panel:ke});ce.Panel;const Mn=d.forwardRef((t,a)=>{const{getPrefixCls:s}=d.useContext(Ve),{prefixCls:n,className:f,showArrow:m=!0}=t,u=s("collapse",n),x=U({[`${u}-no-arrow`]:!m},f);return d.createElement(ce.Panel,Object.assign({ref:a},t,{prefixCls:u,className:x}))}),On=t=>{const{componentCls:a,contentBg:s,padding:n,headerBg:f,headerPadding:m,collapseHeaderPaddingSM:u,collapseHeaderPaddingLG:x,collapsePanelBorderRadius:v,lineWidth:y,lineType:C,colorBorder:$,colorText:h,colorTextHeading:i,colorTextDisabled:c,fontSizeLG:I,lineHeight:g,lineHeightLG:b,marginSM:k,paddingSM:R,paddingLG:l,paddingXS:B,motionDurationSlow:j,fontSizeIcon:M,contentPadding:P,fontHeight:O,fontHeightLG:_}=t,T=`${F(y)} ${C} ${$}`;return{[a]:Object.assign(Object.assign({},Ye(t)),{backgroundColor:f,border:T,borderRadius:v,"&-rtl":{direction:"rtl"},[`& > ${a}-item`]:{borderBottom:T,"&:first-child":{[`
            &,
            & > ${a}-header`]:{borderRadius:`${F(v)} ${F(v)} 0 0`}},"&:last-child":{[`
            &,
            & > ${a}-header`]:{borderRadius:`0 0 ${F(v)} ${F(v)}`}},[`> ${a}-header`]:Object.assign(Object.assign({position:"relative",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",padding:m,color:i,lineHeight:g,cursor:"pointer",transition:`all ${j}, visibility 0s`},Je(t)),{[`> ${a}-header-text`]:{flex:"auto"},[`${a}-expand-icon`]:{height:O,display:"flex",alignItems:"center",paddingInlineEnd:k},[`${a}-arrow`]:Object.assign(Object.assign({},Qe()),{fontSize:M,transition:`transform ${j}`,svg:{transition:`transform ${j}`}}),[`${a}-header-text`]:{marginInlineEnd:"auto"}}),[`${a}-collapsible-header`]:{cursor:"default",[`${a}-header-text`]:{flex:"none",cursor:"pointer"},[`${a}-expand-icon`]:{cursor:"pointer"}},[`${a}-collapsible-icon`]:{cursor:"unset",[`${a}-expand-icon`]:{cursor:"pointer"}}},[`${a}-content`]:{color:h,backgroundColor:s,borderTop:T,[`& > ${a}-content-box`]:{padding:P},"&-hidden":{display:"none"}},"&-small":{[`> ${a}-item`]:{[`> ${a}-header`]:{padding:u,paddingInlineStart:B,[`> ${a}-expand-icon`]:{marginInlineStart:t.calc(R).sub(B).equal()}},[`> ${a}-content > ${a}-content-box`]:{padding:R}}},"&-large":{[`> ${a}-item`]:{fontSize:I,lineHeight:b,[`> ${a}-header`]:{padding:x,paddingInlineStart:n,[`> ${a}-expand-icon`]:{height:_,marginInlineStart:t.calc(l).sub(n).equal()}},[`> ${a}-content > ${a}-content-box`]:{padding:l}}},[`${a}-item:last-child`]:{borderBottom:0,[`> ${a}-content`]:{borderRadius:`0 0 ${F(v)} ${F(v)}`}},[`& ${a}-item-disabled > ${a}-header`]:{"\n          &,\n          & > .arrow\n        ":{color:c,cursor:"not-allowed"}},[`&${a}-icon-position-end`]:{[`& > ${a}-item`]:{[`> ${a}-header`]:{[`${a}-expand-icon`]:{order:1,paddingInlineEnd:0,paddingInlineStart:k}}}}})}},_n=t=>{const{componentCls:a}=t,s=`> ${a}-item > ${a}-header ${a}-arrow`;return{[`${a}-rtl`]:{[s]:{transform:"rotate(180deg)"}}}},En=t=>{const{componentCls:a,headerBg:s,borderlessContentPadding:n,borderlessContentBg:f,colorBorder:m}=t;return{[`${a}-borderless`]:{backgroundColor:s,border:0,[`> ${a}-item`]:{borderBottom:`1px solid ${m}`},[`
        > ${a}-item:last-child,
        > ${a}-item:last-child ${a}-header
      `]:{borderRadius:0},[`> ${a}-item:last-child`]:{borderBottom:0},[`> ${a}-item > ${a}-content`]:{backgroundColor:f,borderTop:0},[`> ${a}-item > ${a}-content > ${a}-content-box`]:{padding:n}}}},An=t=>{const{componentCls:a,paddingSM:s}=t;return{[`${a}-ghost`]:{backgroundColor:"transparent",border:0,[`> ${a}-item`]:{borderBottom:0,[`> ${a}-content`]:{backgroundColor:"transparent",border:0,[`> ${a}-content-box`]:{paddingBlock:s}}}}}},Tn=t=>({headerPadding:`${t.paddingSM}px ${t.padding}px`,headerBg:t.colorFillAlter,contentPadding:`${t.padding}px 16px`,contentBg:t.colorBgContainer,borderlessContentPadding:`${t.paddingXXS}px 16px ${t.padding}px`,borderlessContentBg:"transparent"}),Ln=qe("Collapse",t=>{const a=Xe(t,{collapseHeaderPaddingSM:`${F(t.paddingXS)} ${F(t.paddingSM)}`,collapseHeaderPaddingLG:`${F(t.padding)} ${F(t.paddingLG)}`,collapsePanelBorderRadius:t.borderRadiusLG});return[On(a),En(a),An(a),_n(a),Ue(a)]},Tn),Wn=d.forwardRef((t,a)=>{const{getPrefixCls:s,direction:n,expandIcon:f,className:m,style:u}=Ze("collapse"),{prefixCls:x,className:v,rootClassName:y,style:C,bordered:$=!0,ghost:h,size:i,expandIconPosition:c="start",children:I,destroyInactivePanel:g,destroyOnHidden:b,expandIcon:k}=t,R=en(E=>{var A;return(A=i??E)!==null&&A!==void 0?A:"middle"}),l=s("collapse",x),B=s(),[j,M,P]=Ln(l),O=d.useMemo(()=>c==="left"?"start":c==="right"?"end":c,[c]),_=k??f,T=d.useCallback((E={})=>{const A=typeof _=="function"?_(E):d.createElement(nn,{rotate:E.isActive?n==="rtl"?-90:90:void 0,"aria-label":E.isActive?"expanded":"collapsed"});return ue(A,()=>{var N;return{className:U((N=A.props)===null||N===void 0?void 0:N.className,`${l}-arrow`)}})},[_,l,n]),Y=U(`${l}-icon-position-${O}`,{[`${l}-borderless`]:!$,[`${l}-rtl`]:n==="rtl",[`${l}-ghost`]:!!h,[`${l}-${R}`]:R!=="middle"},m,v,y,M,P),J=d.useMemo(()=>Object.assign(Object.assign({},tn(B)),{motionAppear:!1,leavedClassName:`${l}-content-hidden`}),[B,l]),H=d.useMemo(()=>I?Se(I).map((E,A)=>{var N,L;const G=E.props;if(G!=null&&G.disabled){const Q=(N=E.key)!==null&&N!==void 0?N:String(A),Z=Object.assign(Object.assign({},xe(E.props,["disabled"])),{key:Q,collapsible:(L=G.collapsible)!==null&&L!==void 0?L:"disabled"});return ue(E,Z)}return E}):null,[I]);return j(d.createElement(ce,Object.assign({ref:a,openMotion:J},xe(t,["rootClassName"]),{expandIcon:T,prefixCls:l,className:Y,style:Object.assign(Object.assign({},u),C),destroyInactivePanel:b??g}),H))}),Kn=Object.assign(Wn,{Panel:Mn});async function Dn(t){return(await $e.request({url:"/download/",method:"get",params:t})).data.data}function Hn(t){return $e.request({url:"/download/complete",method:"get",params:{torrent_hash:t}})}const{useToken:Fn}=on;function Yn(){var de;const{message:t,modal:a}=an.useApp(),{token:s}=Fn(),n=rn(),f=sn(),[m,u]=d.useState(),[x,v]=d.useState(),y=vn(x,{wait:1e3}),[C,$]=d.useState(!0),[h,i]=d.useState(!0),[c,I]=d.useState(!1),[g,b]=d.useState({status:"all",sizeRange:[0,1e4],dateRange:null,sortBy:"date",sortOrder:"desc"}),[k,R]=d.useState({total:0,downloading:0,completed:0,failed:0,totalSize:"0 GB"}),[l,B]=d.useState(!1),[j,M]=d.useState(null),[P,O]=d.useState(""),[_,T]=d.useState(!1),[Y,J]=d.useState(!1),[H,E]=d.useState(null),[A,N]=d.useState(!1),{data:L=[],loading:G,refresh:Q}=he(()=>Dn({include_success:C,include_failed:h}),{refreshDeps:[C,h]}),Z=d.useMemo(()=>{let o=L.filter(r=>{if(!(!y||r.name.indexOf(y)!=-1||r.files.some(w=>w.name.indexOf(y)!=-1||w.path.indexOf(y)!=-1)))return!1;const p=r.files.some(w=>w.progress>=1),K=r.files.some(w=>w.progress===0);return!(!C&&p&&!r.files.some(w=>w.progress<1)||!h&&K)});return c&&(o=o.filter(r=>{if(g.status!=="all"){const S=r.files.some(K=>K.progress>=1),p=r.files.some(K=>K.progress>0&&K.progress<1);if(g.status==="completed"&&!S||g.status==="downloading"&&!p)return!1}return!0})),o},[L,y,c,g,C,h]),{run:Pe}=he(Hn,{manual:!0,onSuccess:()=>{t.success("标记成功"),Q()}}),we=async o=>{try{T(!0),O(o);const r=await yn(o);r.success?(M(r.data),B(!0)):t.error(r.message||"获取清理预览失败")}catch(r){t.error((r==null?void 0:r.message)||"获取清理预览失败")}finally{T(!1)}},ze=async()=>{try{T(!0);const o=await bn(P,!1);o.success?(t.success("清理成功"),B(!1),M(null),Q()):t.error(o.message||"清理失败")}catch(o){t.error((o==null?void 0:o.message)||"清理失败")}finally{T(!1)}},Re=()=>{B(!1),M(null),O("")},Be=async()=>{try{N(!0);const o=await ve(void 0,!0);o.success&&o.data?(E(o.data),J(!0)):t.error(o.message||"获取批量清理预览失败")}catch(o){t.error((o==null?void 0:o.message)||"获取批量清理预览失败")}finally{N(!1)}},Ne=async()=>{var o;try{N(!0);const r=await ve(void 0,!1);r.success?(t.success(`批量清理成功，共清理 ${((o=r.data)==null?void 0:o.files_deleted)||0} 个文件`),J(!1),E(null),Q()):t.error(r.message||"批量清理失败")}catch(r){t.error((r==null?void 0:r.message)||"批量清理失败")}finally{N(!1)}},Me=()=>{J(!1),E(null)},Oe=o=>{if(o){const r=new URLSearchParams(window.location.search),S=r.get("source")||"javdb",p=r.get("url")||"";f({to:`/video/${o}`,search:{source:S,url:p}})}else t.info("无法识别番号，无法跳转到详情页面")},_e=o=>{f({to:"/actor",search:{actorName:o}})},Ee=Z.map(o=>({key:o.hash,label:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[e.jsx("span",{style:{color:n.textPrimary,fontWeight:500,fontSize:"14px"},children:o.name}),e.jsx(V,{children:(()=>{const r=o.files.length,S=o.files.filter(w=>w.progress>=1).length,p=o.files.filter(w=>w.progress>0&&w.progress<1).length,K=o.files.reduce((w,Ae)=>w+Ae.progress,0)/r;return e.jsxs(e.Fragment,{children:[e.jsxs(re,{style:{background:S===r?"rgba(82, 196, 26, 0.2)":p>0?n.rgba("gold",.2):n.borderPrimary,borderColor:S===r?"#52c41a":p>0?n.goldPrimary:n.borderPrimary,color:S===r?"#52c41a":p>0?n.goldLight:n.textSecondary,fontWeight:500},children:[S,"/",r," 文件"]}),e.jsx(fe,{percent:Math.round(K*100),size:"small",style:{width:80},strokeColor:S===r?"#52c41a":{"0%":n.goldPrimary,"100%":n.goldLight},trailColor:"rgba(255, 255, 255, 0.08)"})]})})()})]}),children:e.jsx(q,{itemLayout:"horizontal",dataSource:o.files,style:{background:n.bgBase,borderRadius:"8px",padding:"12px"},renderItem:(r,S)=>e.jsx(q.Item,{style:{background:n.bgElevated,borderRadius:"8px",padding:"12px 16px",marginBottom:"8px",border:"1px solid rgba(255, 255, 255, 0.08)",transition:"all 0.3s ease"},onMouseEnter:p=>{p.currentTarget.style.borderColor=n.goldPrimary,p.currentTarget.style.background=n.bgContainer},onMouseLeave:p=>{p.currentTarget.style.borderColor=n.borderPrimary,p.currentTarget.style.background=n.bgElevated},actions:[e.jsx(te,{title:"整理",children:e.jsx(oe,{onClick:()=>{u(r.path)},children:e.jsx(jn,{style:{fontSize:s.sizeLG}})})})],children:e.jsx(q.Item.Meta,{title:e.jsxs("span",{children:[r.num?e.jsx("a",{onClick:()=>Oe(r.num),style:{color:n.goldPrimary,fontWeight:500,transition:"color 0.3s ease"},onMouseEnter:p=>{p.currentTarget.style.color=n.goldLight},onMouseLeave:p=>{p.currentTarget.style.color=n.goldPrimary},children:r.name}):e.jsx("span",{style:{color:n.textPrimary,fontWeight:500},children:r.name}),e.jsx(re,{style:{marginLeft:5,background:"rgba(82, 196, 26, 0.2)",borderColor:"#52c41a",color:"#52c41a",fontWeight:500},children:r.size}),r.progress<1&&e.jsx(fe,{percent:Math.round(r.progress*100),size:"small",style:{width:100,marginLeft:10,display:"inline-block"},strokeColor:{"0%":n.goldPrimary,"100%":n.goldLight},trailColor:"rgba(255, 255, 255, 0.08)"})]}),description:e.jsxs("div",{children:[e.jsx("div",{style:{color:n.textTertiary,fontSize:"13px",marginTop:"4px"},children:r.path}),r.actors&&r.actors.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx(gn,{style:{marginRight:6,color:n.textSecondary}}),r.actors.map((p,K)=>e.jsxs(z.Fragment,{children:[e.jsx("a",{onClick:()=>_e(p),style:{color:n.goldPrimary,fontWeight:500,fontSize:"13px",transition:"color 0.3s ease"},onMouseEnter:w=>{w.currentTarget.style.color=n.goldLight},onMouseLeave:w=>{w.currentTarget.style.color=n.goldPrimary},children:p}),K<r.actors.length-1&&e.jsx("span",{children:", "})]},p))]})]})})})}),extra:e.jsxs(V,{children:[e.jsx(te,{title:"清理文件",children:e.jsx(oe,{onClick:()=>we(o.hash),loading:_&&P===o.hash,children:e.jsx(pe,{style:{fontSize:s.sizeLG,color:n.warning}})})}),e.jsx(te,{title:"重新开始下载",children:e.jsx(oe,{onClick:()=>{t.info("重新开始下载功能开发中...")},children:e.jsx(ln,{style:{fontSize:s.sizeLG,color:"#1890ff"}})})}),e.jsx(te,{title:"暂停下载",children:e.jsx(oe,{onClick:()=>{t.info("暂停下载功能开发中...")},children:e.jsx(cn,{style:{fontSize:s.sizeLG,color:"#faad14"}})})}),e.jsx(te,{title:'标记为"整理成功"',children:e.jsx(oe,{onClick:()=>{a.confirm({title:"是否确认标记为完成",onOk:()=>Pe(o.hash)})},children:e.jsx(In,{style:{fontSize:s.sizeLG,color:"#52c41a"}})})}),e.jsx(te,{title:"删除任务",children:e.jsx(oe,{onClick:()=>{a.confirm({title:"确认删除下载任务？",content:"此操作将删除下载任务，但不会删除已下载的文件",okText:"确认删除",okType:"danger",onOk:()=>{t.info("删除功能开发中...")}})},children:e.jsx(dn,{style:{fontSize:s.sizeLG,color:"#ff4d4f"}})})})]})}));return e.jsxs(ae,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:n.textPrimary,fontSize:"18px",fontWeight:600},children:"下载列表"}),e.jsxs(V,{children:[e.jsx(le,{icon:e.jsx(pe,{}),size:"small",onClick:Be,loading:A,style:{background:n.bgContainer,borderColor:n.warning,color:n.warning,transition:"all 0.3s ease"},children:"批量清理"}),e.jsxs(le,{icon:e.jsx(fn,{}),size:"small",onClick:()=>I(!c),style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textSecondary,transition:"all 0.3s ease"},children:["高级筛选 ",c?"▼":"▶"]}),e.jsx(le,{icon:e.jsx(mn,{}),size:"small",onClick:Q,loading:G,style:{background:"linear-gradient(135deg, #d4a852 0%, #e8c780 100%)",borderColor:n.goldPrimary,color:n.bgBase,fontWeight:600,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:"刷新"})]})]}),loading:G,extra:e.jsxs(V.Compact,{children:[e.jsx(hn,{value:x,onChange:o=>v(o.target.value),placeholder:"搜索",style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textPrimary}}),e.jsx(le,{icon:e.jsx(pn,{}),style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textSecondary}})]}),style:{background:n.bgElevated,borderColor:n.borderPrimary},styles:{header:{background:n.bgBase,borderBottom:"1px solid rgba(255, 255, 255, 0.08)"},body:{background:n.bgElevated}},children:[e.jsxs(se,{gutter:16,style:{marginBottom:20},children:[e.jsx(W,{span:6,children:e.jsx(ae,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(ee,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"总任务数"}),value:L.length,valueStyle:{color:n.textPrimary,fontSize:"24px",fontWeight:600}})})}),e.jsx(W,{span:6,children:e.jsx(ae,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(ee,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"进行中"}),value:L.reduce((o,r)=>o+r.files.filter(S=>S.progress>0&&S.progress<1).length,0),valueStyle:{color:"#4facfe",fontSize:"24px",fontWeight:600}})})}),e.jsx(W,{span:6,children:e.jsx(ae,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(ee,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"已完成"}),value:L.reduce((o,r)=>o+r.files.filter(S=>S.progress>=1).length,0),valueStyle:{color:"#52c41a",fontSize:"24px",fontWeight:600}})})}),e.jsx(W,{span:6,children:e.jsx(ae,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(ee,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"失败/等待"}),value:L.reduce((o,r)=>o+r.files.filter(S=>S.progress===0).length,0),valueStyle:{color:"#ff7875",fontSize:"24px",fontWeight:600}})})})]}),e.jsx(un,{}),e.jsx("div",{style:{marginBottom:16,padding:"12px 16px",background:n.bgContainer,border:"1px solid rgba(255, 255, 255, 0.08)",borderRadius:"8px"},children:e.jsxs(se,{gutter:16,children:[e.jsx(W,{children:e.jsxs(V,{children:[e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"显示已完成:"}),e.jsx(me,{checked:C,onChange:$,size:"small",style:{background:C?n.goldPrimary:"rgba(255, 255, 255, 0.2)"}})]})}),e.jsx(W,{children:e.jsxs(V,{children:[e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"显示失败:"}),e.jsx(me,{checked:h,onChange:i,size:"small",style:{background:h?n.goldPrimary:"rgba(255, 255, 255, 0.2)"}})]})})]})}),c&&e.jsx(ae,{size:"small",style:{marginBottom:16,background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px",background:n.bgContainer}},children:e.jsxs(se,{gutter:[16,8],children:[e.jsxs(W,{span:8,children:[e.jsx("div",{style:{marginBottom:8,color:n.textSecondary,fontSize:"14px",fontWeight:500},children:"状态筛选"}),e.jsxs(D,{value:g.status,onChange:o=>b({...g,status:o}),style:{width:"100%"},dropdownStyle:{background:n.bgContainer,borderColor:n.borderPrimary},children:[e.jsx(D.Option,{value:"all",children:"全部状态"}),e.jsx(D.Option,{value:"downloading",children:"下载中"}),e.jsx(D.Option,{value:"completed",children:"已完成"}),e.jsx(D.Option,{value:"failed",children:"失败/等待"})]})]}),e.jsxs(W,{span:8,children:[e.jsx("div",{style:{marginBottom:8,color:n.textSecondary,fontSize:"14px",fontWeight:500},children:"排序方式"}),e.jsxs(D,{value:`${g.sortBy}-${g.sortOrder}`,onChange:o=>{const[r,S]=o.split("-");b({...g,sortBy:r,sortOrder:S})},style:{width:"100%"},dropdownStyle:{background:n.bgContainer,borderColor:n.borderPrimary},children:[e.jsx(D.Option,{value:"date-desc",children:"添加时间 (新→旧)"}),e.jsx(D.Option,{value:"date-asc",children:"添加时间 (旧→新)"}),e.jsx(D.Option,{value:"progress-desc",children:"进度 (高→低)"}),e.jsx(D.Option,{value:"progress-asc",children:"进度 (低→高)"}),e.jsx(D.Option,{value:"size-desc",children:"大小 (大→小)"}),e.jsx(D.Option,{value:"size-asc",children:"大小 (小→大)"})]})]}),e.jsxs(W,{span:8,children:[e.jsx("div",{style:{marginBottom:8,color:n.textSecondary,fontSize:"14px",fontWeight:500},children:"快速操作"}),e.jsx(V,{children:e.jsx(le,{size:"small",onClick:()=>{b({status:"all",sizeRange:[0,1e4],dateRange:null,sortBy:"date",sortOrder:"desc"}),v("")},style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textSecondary},children:"重置筛选"})})]})]})}),Z.length>0?e.jsxs(e.Fragment,{children:[Z.length!==L.length&&e.jsx("div",{style:{marginBottom:16,padding:"12px 16px",background:n.bgContainer,border:"1px solid rgba(255, 255, 255, 0.08)",borderRadius:8},children:e.jsxs(V,{children:[e.jsx(ye,{count:Z.length,style:{background:"linear-gradient(135deg, #d4a852 0%, #e8c780 100%)",color:n.bgBase,fontWeight:600,boxShadow:"0 2px 8px rgba(212, 168, 82, 0.3)"}}),e.jsxs("span",{style:{color:n.textSecondary,fontSize:"14px"},children:["筛选结果：",Z.length," / ",L.length," 个任务"]})]})}),e.jsx(Kn,{items:Ee,ghost:!0})]}):L.length>0?e.jsx(ie,{description:"没有符合筛选条件的下载任务"}):e.jsx(ie,{description:e.jsxs("span",{children:["无下载任务，",e.jsx(xn,{to:"/setting/download",children:"配置下载"})]})}),e.jsx(Cn,{title:"下载整理",mode:"download",width:1100,path:m,open:!!m,onCancel:()=>u(void 0),onOk:()=>{u(void 0),Q()}}),e.jsx(be,{title:"清理文件预览",open:l,onOk:ze,onCancel:Re,okText:"确认清理",cancelText:"取消",okButtonProps:{danger:!0,loading:_},width:800,styles:{body:{background:n.bgBase,maxHeight:"500px",overflowY:"auto"}},children:j&&e.jsxs("div",{style:{color:n.textPrimary},children:[e.jsx("div",{style:{marginBottom:16,padding:"12px 16px",background:n.bgContainer,borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:e.jsxs(se,{gutter:16,children:[e.jsxs(W,{span:12,children:[e.jsx("span",{style:{color:n.textSecondary},children:"将要删除的文件数："}),e.jsx("span",{style:{color:"#ff4d4f",fontWeight:600,marginLeft:8},children:((de=j.files_to_delete)==null?void 0:de.length)||0})]}),e.jsxs(W,{span:12,children:[e.jsx("span",{style:{color:n.textSecondary},children:"预计释放空间："}),e.jsx("span",{style:{color:"#52c41a",fontWeight:600,marginLeft:8},children:j.total_size||"0 MB"})]})]})}),j.files_to_delete&&j.files_to_delete.length>0?e.jsx(q,{dataSource:j.files_to_delete,renderItem:o=>e.jsx(q.Item,{style:{background:n.bgElevated,borderRadius:"8px",padding:"12px 16px",marginBottom:"8px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:e.jsx(q.Item.Meta,{title:e.jsx("span",{style:{color:n.textPrimary},children:o.name}),description:e.jsxs("div",{children:[e.jsx("div",{style:{color:n.textTertiary,fontSize:"13px"},children:o.path}),e.jsxs(V,{style:{marginTop:4},children:[e.jsx(re,{style:{background:"rgba(255, 77, 79, 0.2)",borderColor:"#ff4d4f",color:"#ff4d4f"},children:o.size}),o.reason&&e.jsx(re,{style:{background:"rgba(250, 173, 20, 0.2)",borderColor:n.warning,color:n.warning},children:o.reason})]})]})})})}):e.jsx(ie,{description:"没有需要清理的文件",style:{color:n.textSecondary}})]})}),e.jsx(be,{title:"批量清理预览",open:Y,onOk:Ne,onCancel:Me,okText:"确认批量清理",cancelText:"取消",okButtonProps:{danger:!0,loading:A},width:900,styles:{body:{background:n.bgBase,maxHeight:"600px",overflowY:"auto"}},children:H&&e.jsxs("div",{style:{color:n.textPrimary},children:[e.jsx("div",{style:{marginBottom:16,padding:"16px",background:n.bgContainer,borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:e.jsxs(se,{gutter:16,children:[e.jsx(W,{span:8,children:e.jsx(ee,{title:e.jsx("span",{style:{color:n.textSecondary},children:"将要清理的种子数"}),value:H.torrents_processed||0,valueStyle:{color:n.goldPrimary,fontWeight:600}})}),e.jsx(W,{span:8,children:e.jsx(ee,{title:e.jsx("span",{style:{color:n.textSecondary},children:"总共要删除的文件数"}),value:H.files_deleted||0,valueStyle:{color:"#ff4d4f",fontWeight:600}})}),e.jsx(W,{span:8,children:e.jsx(ee,{title:e.jsx("span",{style:{color:n.textSecondary},children:"预计释放空间"}),value:(H.space_freed_mb||0)/1024,precision:2,suffix:"GB",valueStyle:{color:"#52c41a",fontWeight:600}})})]})}),H.details&&H.details.length>0?e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:12,color:n.textSecondary,fontSize:"14px",fontWeight:500},children:"详细清理列表："}),e.jsx(q,{dataSource:H.details,renderItem:(o,r)=>{var S;return e.jsx(q.Item,{style:{background:n.bgElevated,borderRadius:"8px",padding:"12px 16px",marginBottom:"8px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:e.jsxs("div",{style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[e.jsx(ye,{count:r+1,style:{background:n.goldPrimary,marginRight:8}}),e.jsx("span",{style:{color:n.textPrimary,fontWeight:500,fontSize:"14px"},children:o.torrent_name||"未知种子"}),e.jsxs(re,{style:{marginLeft:"auto",background:"rgba(255, 77, 79, 0.2)",borderColor:"#ff4d4f",color:"#ff4d4f"},children:[((S=o.files_removed)==null?void 0:S.length)||0," 个文件"]})]}),o.files_removed&&o.files_removed.length>0&&e.jsx("div",{style:{paddingLeft:32,color:n.textTertiary,fontSize:"13px"},children:o.files_removed.map((p,K)=>e.jsx("div",{style:{padding:"4px 0",borderBottom:K<o.files_removed.length-1?"1px solid rgba(255, 255, 255, 0.05)":"none"},children:p},K))})]})})}})]}):e.jsx(ie,{description:"没有需要批量清理的文件",style:{color:n.textSecondary}})]})})]})}export{Yn as component};
