import{as as x,F as e,ak as S,at as O,au as w,U as y,O as b,aB as I,r as d,av as p,S as M,R as z,G as k,N as C,aC as B,aD as P,Z as D,ab as N,W as v,aE as U,az as $,aF as G}from"./index-CIppsPuS.js";import{V as W}from"./index-492MB-Gu.js";function _(o){const{onFilter:u,actors:m=[],initialValues:j,...h}=o,[a]=x.useForm();async function f(){const n=await a.validateFields();u(n)}function c(){a.resetFields(),u({})}const t=m.map(n=>({label:`${n.name}(${n.count}部)`,value:n.name}));return e.jsx(S,{title:"影片过滤",...h,footer:e.jsxs(y,{children:[e.jsx(b,{onClick:c,children:"重 制"}),e.jsx(b,{type:"primary",onClick:f,children:"确 定"})]}),children:e.jsxs(x,{form:a,layout:"vertical",initialValues:j,children:[e.jsx(x.Item,{name:"title",label:"标题",children:e.jsx(O,{allowClear:!0})}),e.jsx(x.Item,{name:"actors",label:"演员",children:e.jsx(w.Group,{options:t})})]})})}function T(){var F;const{data:o=[],loading:u,run:m,refresh:j}=I(G),[h,a]=d.useState(),[f,c]=d.useState(!1),[t,n]=d.useState({}),E=d.useMemo(()=>{const s=[];return o.forEach(r=>{r.actors.forEach(l=>{const i=s.find(R=>R.name==l.name);i?i.count=i.count+1:(l.count=1,s.push(l))})}),s},[o]),g=d.useMemo(()=>o.filter(s=>{var r;return t.title&&!s.title.toUpperCase().includes(t.title.toUpperCase())?!1:(r=t.actors)!=null&&r.length?s.actors.map(l=>l.name).filter(l=>{var i;return(i=t.actors)==null?void 0:i.includes(l)}).length>0:!0}),[t,o]),V=!!t.title||!!((F=t.actors)!=null&&F.length);return u?e.jsx(p,{children:e.jsx(M,{active:!0})}):e.jsxs(z,{gutter:[15,15],children:[g.length>0?g.map(s=>e.jsx(k,{span:24,md:12,lg:6,children:e.jsx(p,{hoverable:!0,size:"small",cover:e.jsx(B,{src:s.cover}),onClick:()=>a(s.path),children:e.jsx(p.Meta,{title:s.title,description:e.jsx("div",{className:"overflow-x-scroll",style:{scrollbarWidth:"none"},children:e.jsxs(y,{size:[0,"small"],children:[s.is_zh&&e.jsx(C,{color:"blue",bordered:!1,children:"中文"}),s.is_uncensored&&e.jsx(C,{color:"green",bordered:!1,children:"无码"}),s.actors.map(r=>e.jsx(C,{color:"purple",bordered:!1,children:r.name},r))]})})})})},s.path)):e.jsx(k,{span:24,children:e.jsx(p,{title:"视频",children:e.jsx(P,{description:e.jsxs("span",{children:["无视频，",e.jsx(D,{to:"/setting",hash:"video",children:"配置视频"})]})})})}),e.jsx(W,{title:"编辑",mode:"video",width:1100,path:h,open:!!h,onCancel:()=>a(void 0),onOk:()=>{a(void 0),j()}}),e.jsx(_,{open:f,actors:E,initialValues:t,onCancel:()=>c(!1),onFilter:s=>{n(s),c(!1)}}),e.jsx(e.Fragment,{children:N.createPortal(e.jsxs(e.Fragment,{children:[e.jsx(v,{icon:e.jsx(U,{}),onClick:()=>m(!0)}),e.jsx(v,{icon:e.jsx($,{}),type:V?"primary":"default",onClick:()=>c(!0)})]}),document.getElementsByClassName("index-float-button-group")[0])})]})}export{T as component};
