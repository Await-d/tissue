import{r as d,I as Le,_ as te,b3 as z,b as Se,c as U,e as X,a as $e,K as ue,d as We,C as Ke,x as Ie,bc as De,w as He,p as Fe,bd as Ge,D as Ve,v as qe,j as Xe,m as Ue,k as F,be as Ye,bf as Je,l as Qe,bg as Ze,g as en,bh as nn,bi as tn,bj as xe,bk as rn,A as he,aM as ke,aN as on,a8 as an,W as sn,$ as ln,aB as pe,F as e,U as V,aU as ee,bl as fe,b0 as cn,bm as dn,aV as gn,J as q,al as un,N as se,M as me,av as re,R as le,G as W,H as ne,b2 as xn,bn as ye,a$ as D,O as oe,V as be,aD as ie,a0 as hn,am as ve,at as pn,aq as Ce,az as fn,bo as mn,bp as yn,bq as bn,br as je}from"./index-zbzQnAx1.js";import{u as vn}from"./index-eyKlPYFE.js";import{I as ae}from"./index-cq_6KPe-.js";import{V as Cn}from"./index-deJpme4p.js";import{R as jn}from"./FolderViewOutlined-gw0BR2Mz.js";var Sn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm376 116c-119.3 0-216 96.7-216 216s96.7 216 216 216 216-96.7 216-216-96.7-216-216-216zm107.5 323.5C750.8 868.2 712.6 884 672 884s-78.8-15.8-107.5-44.5C535.8 810.8 520 772.6 520 732s15.8-78.8 44.5-107.5C593.2 595.8 631.4 580 672 580s78.8 15.8 107.5 44.5C808.2 653.2 824 691.4 824 732s-15.8 78.8-44.5 107.5zM761 656h-44.3c-2.6 0-5 1.2-6.5 3.3l-63.5 87.8-23.1-31.9a7.92 7.92 0 00-6.5-3.3H573c-6.5 0-10.3 7.4-6.5 12.7l73.8 102.1c3.2 4.4 9.7 4.4 12.9 0l114.2-158c3.9-5.3.1-12.7-6.4-12.7zM440 852H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"file-done",theme:"outlined"},$n=function(r,s){return d.createElement(Le,te({},r,{ref:s,icon:Sn}))},In=d.forwardRef($n),Pe=z.forwardRef(function(t,r){var s=t.prefixCls,n=t.forceRender,f=t.className,m=t.style,u=t.children,x=t.isActive,v=t.role,y=t.classNames,C=t.styles,$=z.useState(x||n),h=Se($,2),i=h[0],c=h[1];return z.useEffect(function(){(n||x)&&c(!0)},[n,x]),i?z.createElement("div",{ref:r,className:U("".concat(s,"-content"),X(X({},"".concat(s,"-content-active"),x),"".concat(s,"-content-inactive"),!x),f),style:m,role:v},z.createElement("div",{className:U("".concat(s,"-content-box"),y==null?void 0:y.body),style:C==null?void 0:C.body},u)):null});Pe.displayName="PanelContent";var kn=["showArrow","headerClass","isActive","onItemClick","forceRender","className","classNames","styles","prefixCls","collapsible","accordion","panelKey","extra","header","expandIcon","openMotion","destroyInactivePanel","children"],we=z.forwardRef(function(t,r){var s=t.showArrow,n=s===void 0?!0:s,f=t.headerClass,m=t.isActive,u=t.onItemClick,x=t.forceRender,v=t.className,y=t.classNames,C=y===void 0?{}:y,$=t.styles,h=$===void 0?{}:$,i=t.prefixCls,c=t.collapsible,I=t.accordion,g=t.panelKey,b=t.extra,k=t.header,R=t.expandIcon,l=t.openMotion,B=t.destroyInactivePanel,j=t.children,_=$e(t,kn),P=c==="disabled",M=b!=null&&typeof b!="boolean",O=X(X(X({onClick:function(){u==null||u(g)},onKeyDown:function(N){(N.key==="Enter"||N.keyCode===ue.ENTER||N.which===ue.ENTER)&&(u==null||u(g))},role:I?"tab":"button"},"aria-expanded",m),"aria-disabled",P),"tabIndex",P?-1:0),T=typeof R=="function"?R(t):z.createElement("i",{className:"arrow"}),Y=T&&z.createElement("div",te({className:"".concat(i,"-expand-icon")},["header","icon"].includes(c)?O:{}),T),J=U("".concat(i,"-item"),X(X({},"".concat(i,"-item-active"),m),"".concat(i,"-item-disabled"),P),v),H=U(f,"".concat(i,"-header"),X({},"".concat(i,"-collapsible-").concat(c),!!c),C.header),E=We({className:H,style:h.header},["header","icon"].includes(c)?{}:O);return z.createElement("div",te({},_,{ref:r,className:J}),z.createElement("div",E,n&&Y,z.createElement("span",te({className:"".concat(i,"-header-text")},c==="header"?O:{}),k),M&&z.createElement("div",{className:"".concat(i,"-extra")},b)),z.createElement(Ke,te({visible:m,leavedClassName:"".concat(i,"-content-hidden")},l,{forceRender:x,removeOnLeave:B}),function(A,N){var L=A.className,G=A.style;return z.createElement(Pe,{ref:N,prefixCls:i,className:L,classNames:C,style:G,styles:h,isActive:m,forceRender:x,role:I?"tabpanel":void 0},j)}))}),Pn=["children","label","key","collapsible","onItemClick","destroyInactivePanel"],wn=function(r,s){var n=s.prefixCls,f=s.accordion,m=s.collapsible,u=s.destroyInactivePanel,x=s.onItemClick,v=s.activeKey,y=s.openMotion,C=s.expandIcon;return r.map(function($,h){var i=$.children,c=$.label,I=$.key,g=$.collapsible,b=$.onItemClick,k=$.destroyInactivePanel,R=$e($,Pn),l=String(I??h),B=g??m,j=k??u,_=function(O){B!=="disabled"&&(x(O),b==null||b(O))},P=!1;return f?P=v[0]===l:P=v.indexOf(l)>-1,z.createElement(we,te({},R,{prefixCls:n,key:l,panelKey:l,isActive:P,accordion:f,openMotion:y,expandIcon:C,header:c,collapsible:B,onItemClick:_,destroyInactivePanel:j}),i)})},zn=function(r,s,n){if(!r)return null;var f=n.prefixCls,m=n.accordion,u=n.collapsible,x=n.destroyInactivePanel,v=n.onItemClick,y=n.activeKey,C=n.openMotion,$=n.expandIcon,h=r.key||String(s),i=r.props,c=i.header,I=i.headerClass,g=i.destroyInactivePanel,b=i.collapsible,k=i.onItemClick,R=!1;m?R=y[0]===h:R=y.indexOf(h)>-1;var l=b??u,B=function(P){l!=="disabled"&&(v(P),k==null||k(P))},j={key:h,panelKey:h,header:c,headerClass:I,isActive:R,prefixCls:f,destroyInactivePanel:g??x,openMotion:C,accordion:m,children:r.props.children,onItemClick:B,expandIcon:$,collapsible:l};return typeof r.type=="string"?r:(Object.keys(j).forEach(function(_){typeof j[_]>"u"&&delete j[_]}),z.cloneElement(r,j))};function Rn(t,r,s){return Array.isArray(t)?wn(t,s):Ie(r).map(function(n,f){return zn(n,f,s)})}function Bn(t){var r=t;if(!Array.isArray(r)){var s=Ge(r);r=s==="number"||s==="string"?[r]:[]}return r.map(function(n){return String(n)})}var Nn=z.forwardRef(function(t,r){var s=t.prefixCls,n=s===void 0?"rc-collapse":s,f=t.destroyInactivePanel,m=f===void 0?!1:f,u=t.style,x=t.accordion,v=t.className,y=t.children,C=t.collapsible,$=t.openMotion,h=t.expandIcon,i=t.activeKey,c=t.defaultActiveKey,I=t.onChange,g=t.items,b=U(n,v),k=De([],{value:i,onChange:function(M){return I==null?void 0:I(M)},defaultValue:c,postState:Bn}),R=Se(k,2),l=R[0],B=R[1],j=function(M){return B(function(){if(x)return l[0]===M?[]:[M];var O=l.indexOf(M),T=O>-1;return T?l.filter(function(Y){return Y!==M}):[].concat(Ve(l),[M])})};He(!y,"[rc-collapse] `children` will be removed in next major version. Please use `items` instead.");var _=Rn(g,y,{prefixCls:n,accordion:x,openMotion:$,expandIcon:h,collapsible:C,destroyInactivePanel:m,onItemClick:j,activeKey:l});return z.createElement("div",te({ref:r,className:b,style:u,role:x?"tablist":void 0},Fe(t,{aria:!0,data:!0})),_)});const ce=Object.assign(Nn,{Panel:we});ce.Panel;const _n=d.forwardRef((t,r)=>{const{getPrefixCls:s}=d.useContext(qe),{prefixCls:n,className:f,showArrow:m=!0}=t,u=s("collapse",n),x=U({[`${u}-no-arrow`]:!m},f);return d.createElement(ce.Panel,Object.assign({ref:r},t,{prefixCls:u,className:x}))}),Mn=t=>{const{componentCls:r,contentBg:s,padding:n,headerBg:f,headerPadding:m,collapseHeaderPaddingSM:u,collapseHeaderPaddingLG:x,collapsePanelBorderRadius:v,lineWidth:y,lineType:C,colorBorder:$,colorText:h,colorTextHeading:i,colorTextDisabled:c,fontSizeLG:I,lineHeight:g,lineHeightLG:b,marginSM:k,paddingSM:R,paddingLG:l,paddingXS:B,motionDurationSlow:j,fontSizeIcon:_,contentPadding:P,fontHeight:M,fontHeightLG:O}=t,T=`${F(y)} ${C} ${$}`;return{[r]:Object.assign(Object.assign({},Je(t)),{backgroundColor:f,border:T,borderRadius:v,"&-rtl":{direction:"rtl"},[`& > ${r}-item`]:{borderBottom:T,"&:first-child":{[`
            &,
            & > ${r}-header`]:{borderRadius:`${F(v)} ${F(v)} 0 0`}},"&:last-child":{[`
            &,
            & > ${r}-header`]:{borderRadius:`0 0 ${F(v)} ${F(v)}`}},[`> ${r}-header`]:Object.assign(Object.assign({position:"relative",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",padding:m,color:i,lineHeight:g,cursor:"pointer",transition:`all ${j}, visibility 0s`},Qe(t)),{[`> ${r}-header-text`]:{flex:"auto"},[`${r}-expand-icon`]:{height:M,display:"flex",alignItems:"center",paddingInlineEnd:k},[`${r}-arrow`]:Object.assign(Object.assign({},Ze()),{fontSize:_,transition:`transform ${j}`,svg:{transition:`transform ${j}`}}),[`${r}-header-text`]:{marginInlineEnd:"auto"}}),[`${r}-collapsible-header`]:{cursor:"default",[`${r}-header-text`]:{flex:"none",cursor:"pointer"},[`${r}-expand-icon`]:{cursor:"pointer"}},[`${r}-collapsible-icon`]:{cursor:"unset",[`${r}-expand-icon`]:{cursor:"pointer"}}},[`${r}-content`]:{color:h,backgroundColor:s,borderTop:T,[`& > ${r}-content-box`]:{padding:P},"&-hidden":{display:"none"}},"&-small":{[`> ${r}-item`]:{[`> ${r}-header`]:{padding:u,paddingInlineStart:B,[`> ${r}-expand-icon`]:{marginInlineStart:t.calc(R).sub(B).equal()}},[`> ${r}-content > ${r}-content-box`]:{padding:R}}},"&-large":{[`> ${r}-item`]:{fontSize:I,lineHeight:b,[`> ${r}-header`]:{padding:x,paddingInlineStart:n,[`> ${r}-expand-icon`]:{height:O,marginInlineStart:t.calc(l).sub(n).equal()}},[`> ${r}-content > ${r}-content-box`]:{padding:l}}},[`${r}-item:last-child`]:{borderBottom:0,[`> ${r}-content`]:{borderRadius:`0 0 ${F(v)} ${F(v)}`}},[`& ${r}-item-disabled > ${r}-header`]:{"\n          &,\n          & > .arrow\n        ":{color:c,cursor:"not-allowed"}},[`&${r}-icon-position-end`]:{[`& > ${r}-item`]:{[`> ${r}-header`]:{[`${r}-expand-icon`]:{order:1,paddingInlineEnd:0,paddingInlineStart:k}}}}})}},On=t=>{const{componentCls:r}=t,s=`> ${r}-item > ${r}-header ${r}-arrow`;return{[`${r}-rtl`]:{[s]:{transform:"rotate(180deg)"}}}},En=t=>{const{componentCls:r,headerBg:s,borderlessContentPadding:n,borderlessContentBg:f,colorBorder:m}=t;return{[`${r}-borderless`]:{backgroundColor:s,border:0,[`> ${r}-item`]:{borderBottom:`1px solid ${m}`},[`
        > ${r}-item:last-child,
        > ${r}-item:last-child ${r}-header
      `]:{borderRadius:0},[`> ${r}-item:last-child`]:{borderBottom:0},[`> ${r}-item > ${r}-content`]:{backgroundColor:f,borderTop:0},[`> ${r}-item > ${r}-content > ${r}-content-box`]:{padding:n}}}},An=t=>{const{componentCls:r,paddingSM:s}=t;return{[`${r}-ghost`]:{backgroundColor:"transparent",border:0,[`> ${r}-item`]:{borderBottom:0,[`> ${r}-content`]:{backgroundColor:"transparent",border:0,[`> ${r}-content-box`]:{paddingBlock:s}}}}}},Tn=t=>({headerPadding:`${t.paddingSM}px ${t.padding}px`,headerBg:t.colorFillAlter,contentPadding:`${t.padding}px 16px`,contentBg:t.colorBgContainer,borderlessContentPadding:`${t.paddingXXS}px 16px ${t.padding}px`,borderlessContentBg:"transparent"}),Ln=Xe("Collapse",t=>{const r=Ue(t,{collapseHeaderPaddingSM:`${F(t.paddingXS)} ${F(t.paddingSM)}`,collapseHeaderPaddingLG:`${F(t.padding)} ${F(t.paddingLG)}`,collapsePanelBorderRadius:t.borderRadiusLG});return[Mn(r),En(r),An(r),On(r),Ye(r)]},Tn),Wn=d.forwardRef((t,r)=>{const{getPrefixCls:s,direction:n,expandIcon:f,className:m,style:u}=en("collapse"),{prefixCls:x,className:v,rootClassName:y,style:C,bordered:$=!0,ghost:h,size:i,expandIconPosition:c="start",children:I,destroyInactivePanel:g,destroyOnHidden:b,expandIcon:k}=t,R=nn(E=>{var A;return(A=i??E)!==null&&A!==void 0?A:"middle"}),l=s("collapse",x),B=s(),[j,_,P]=Ln(l),M=d.useMemo(()=>c==="left"?"start":c==="right"?"end":c,[c]),O=k??f,T=d.useCallback((E={})=>{const A=typeof O=="function"?O(E):d.createElement(tn,{rotate:E.isActive?n==="rtl"?-90:90:void 0,"aria-label":E.isActive?"expanded":"collapsed"});return xe(A,()=>{var N;return{className:U((N=A.props)===null||N===void 0?void 0:N.className,`${l}-arrow`)}})},[O,l,n]),Y=U(`${l}-icon-position-${M}`,{[`${l}-borderless`]:!$,[`${l}-rtl`]:n==="rtl",[`${l}-ghost`]:!!h,[`${l}-${R}`]:R!=="middle"},m,v,y,_,P),J=d.useMemo(()=>Object.assign(Object.assign({},rn(B)),{motionAppear:!1,leavedClassName:`${l}-content-hidden`}),[B,l]),H=d.useMemo(()=>I?Ie(I).map((E,A)=>{var N,L;const G=E.props;if(G!=null&&G.disabled){const Q=(N=E.key)!==null&&N!==void 0?N:String(A),Z=Object.assign(Object.assign({},he(E.props,["disabled"])),{key:Q,collapsible:(L=G.collapsible)!==null&&L!==void 0?L:"disabled"});return xe(E,Z)}return E}):null,[I]);return j(d.createElement(ce,Object.assign({ref:r,openMotion:J},he(t,["rootClassName"]),{expandIcon:T,prefixCls:l,className:Y,style:Object.assign(Object.assign({},u),C),destroyInactivePanel:b??g}),H))}),Kn=Object.assign(Wn,{Panel:_n});async function Dn(t){return(await ke.request({url:"/download/",method:"get",params:t})).data}function Hn(t){return ke.request({url:"/download/complete",method:"get",params:{torrent_hash:t}})}const{useToken:Fn}=an;function Yn(){var ge;const{message:t,modal:r}=on.useApp(),{token:s}=Fn(),n=sn(),f=ln(),[m,u]=d.useState(),[x,v]=d.useState(),y=vn(x,{wait:1e3}),[C,$]=d.useState(!0),[h,i]=d.useState(!0),[c,I]=d.useState(!1),[g,b]=d.useState({status:"all",sizeRange:[0,1e4],dateRange:null,sortBy:"date",sortOrder:"desc"}),[k,R]=d.useState({total:0,downloading:0,completed:0,failed:0,totalSize:"0 GB"}),[l,B]=d.useState(!1),[j,_]=d.useState(null),[P,M]=d.useState(""),[O,T]=d.useState(!1),[Y,J]=d.useState(!1),[H,E]=d.useState(null),[A,N]=d.useState(!1),{data:L=[],loading:G,refresh:Q}=pe(()=>Dn({include_success:C,include_failed:h}),{refreshDeps:[C,h]}),Z=d.useMemo(()=>{let o=L.filter(a=>{if(!(!y||a.name.indexOf(y)!=-1||a.files.some(w=>w.name.indexOf(y)!=-1||w.path.indexOf(y)!=-1)))return!1;const p=a.files.some(w=>w.progress>=1),K=a.files.some(w=>w.progress===0);return!(!C&&p&&!a.files.some(w=>w.progress<1)||!h&&K)});return c&&(o=o.filter(a=>{if(g.status!=="all"){const S=a.files.some(K=>K.progress>=1),p=a.files.some(K=>K.progress>0&&K.progress<1);if(g.status==="completed"&&!S||g.status==="downloading"&&!p)return!1}return!0})),o},[L,y,c,g,C,h]),{run:ze}=pe(Hn,{manual:!0,onSuccess:()=>{t.success("标记成功"),Q()}}),Re=async o=>{try{T(!0),M(o);const a=await yn(o);a.success?(_(a.data),B(!0)):t.error(a.message||"获取清理预览失败")}catch(a){t.error((a==null?void 0:a.message)||"获取清理预览失败")}finally{T(!1)}},Be=async()=>{try{T(!0);const o=await bn(P,!1);o.success?(t.success("清理成功"),B(!1),_(null),Q()):t.error(o.message||"清理失败")}catch(o){t.error((o==null?void 0:o.message)||"清理失败")}finally{T(!1)}},Ne=()=>{B(!1),_(null),M("")},de=async()=>{try{N(!0);const o=await je(void 0,!0);o.success&&o.data?(E(o.data),J(!0)):t.error(o.message||"获取批量清理预览失败")}catch(o){t.error((o==null?void 0:o.message)||"获取批量清理预览失败")}finally{N(!1)}},_e=async()=>{var o;try{N(!0);const a=await je(void 0,!1);a.success?(t.success(`批量清理成功，共清理 ${((o=a.data)==null?void 0:o.files_deleted)||0} 个文件`),J(!1),E(null),Q()):t.error(a.message||"批量清理失败")}catch(a){t.error((a==null?void 0:a.message)||"批量清理失败")}finally{N(!1)}},Me=()=>{J(!1),E(null)},Oe=o=>{if(o){const a=new URLSearchParams(window.location.search),S=a.get("source")||"javdb",p=a.get("url")||"";f({to:`/video/${o}`,search:{source:S,url:p}})}else t.info("无法识别番号，无法跳转到详情页面")},Ee=o=>{f({to:"/actor",search:{actorName:o}})},Ae=Z.map(o=>({key:o.hash,label:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[e.jsx("span",{style:{color:n.textPrimary,fontWeight:500,fontSize:"14px"},children:o.name}),e.jsx(V,{children:(()=>{const a=o.files.length,S=o.files.filter(w=>w.progress>=1).length,p=o.files.filter(w=>w.progress>0&&w.progress<1).length,K=o.files.reduce((w,Te)=>w+Te.progress,0)/a;return e.jsxs(e.Fragment,{children:[e.jsxs(se,{style:{background:S===a?"rgba(82, 196, 26, 0.2)":p>0?n.rgba("gold",.2):n.borderPrimary,borderColor:S===a?"#52c41a":p>0?n.goldPrimary:n.borderPrimary,color:S===a?"#52c41a":p>0?n.goldLight:n.textSecondary,fontWeight:500},children:[S,"/",a," 文件"]}),e.jsx(me,{percent:Math.round(K*100),size:"small",style:{width:80},strokeColor:S===a?"#52c41a":{"0%":n.goldPrimary,"100%":n.goldLight},trailColor:"rgba(255, 255, 255, 0.08)"})]})})()})]}),children:e.jsx(q,{itemLayout:"horizontal",dataSource:o.files,style:{background:n.bgBase,borderRadius:"8px",padding:"12px"},renderItem:(a,S)=>e.jsx(q.Item,{style:{background:n.bgElevated,borderRadius:"8px",padding:"12px 16px",marginBottom:"8px",border:"1px solid rgba(255, 255, 255, 0.08)",transition:"all 0.3s ease"},onMouseEnter:p=>{p.currentTarget.style.borderColor=n.goldPrimary,p.currentTarget.style.background=n.bgContainer},onMouseLeave:p=>{p.currentTarget.style.borderColor=n.borderPrimary,p.currentTarget.style.background=n.bgElevated},actions:[e.jsx(ee,{title:"整理",children:e.jsx(ae,{onClick:()=>{u(a.path)},children:e.jsx(jn,{style:{fontSize:s.sizeLG}})})})],children:e.jsx(q.Item.Meta,{title:e.jsxs("span",{children:[a.num?e.jsx("a",{onClick:()=>Oe(a.num),style:{color:n.goldPrimary,fontWeight:500,transition:"color 0.3s ease"},onMouseEnter:p=>{p.currentTarget.style.color=n.goldLight},onMouseLeave:p=>{p.currentTarget.style.color=n.goldPrimary},children:a.name}):e.jsx("span",{style:{color:n.textPrimary,fontWeight:500},children:a.name}),e.jsx(se,{style:{marginLeft:5,background:"rgba(82, 196, 26, 0.2)",borderColor:"#52c41a",color:"#52c41a",fontWeight:500},children:a.size}),a.progress<1&&e.jsx(me,{percent:Math.round(a.progress*100),size:"small",style:{width:100,marginLeft:10,display:"inline-block"},strokeColor:{"0%":n.goldPrimary,"100%":n.goldLight},trailColor:"rgba(255, 255, 255, 0.08)"})]}),description:e.jsxs("div",{children:[e.jsx("div",{style:{color:n.textTertiary,fontSize:"13px",marginTop:"4px"},children:a.path}),a.actors&&a.actors.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx(un,{style:{marginRight:6,color:n.textSecondary}}),a.actors.map((p,K)=>e.jsxs(z.Fragment,{children:[e.jsx("a",{onClick:()=>Ee(p),style:{color:n.goldPrimary,fontWeight:500,fontSize:"13px",transition:"color 0.3s ease"},onMouseEnter:w=>{w.currentTarget.style.color=n.goldLight},onMouseLeave:w=>{w.currentTarget.style.color=n.goldPrimary},children:p}),K<a.actors.length-1&&e.jsx("span",{children:", "})]},p))]})]})})})}),extra:e.jsxs(V,{children:[e.jsx(ee,{title:"清理文件",children:e.jsx(ae,{onClick:()=>Re(o.hash),loading:O&&P===o.hash,children:e.jsx(fe,{style:{fontSize:s.sizeLG,color:n.warning}})})}),e.jsx(ee,{title:"重新开始下载",children:e.jsx(ae,{onClick:()=>{t.info("重新开始下载功能开发中...")},children:e.jsx(cn,{style:{fontSize:s.sizeLG,color:"#1890ff"}})})}),e.jsx(ee,{title:"暂停下载",children:e.jsx(ae,{onClick:()=>{t.info("暂停下载功能开发中...")},children:e.jsx(dn,{style:{fontSize:s.sizeLG,color:"#faad14"}})})}),e.jsx(ee,{title:'标记为"整理成功"',children:e.jsx(ae,{onClick:()=>{r.confirm({title:"是否确认标记为完成",onOk:()=>ze(o.hash)})},children:e.jsx(In,{style:{fontSize:s.sizeLG,color:"#52c41a"}})})}),e.jsx(ee,{title:"删除任务",children:e.jsx(ae,{onClick:()=>{r.confirm({title:"确认删除下载任务？",content:"此操作将删除下载任务，但不会删除已下载的文件",okText:"确认删除",okType:"danger",onOk:()=>{t.info("删除功能开发中...")}})},children:e.jsx(gn,{style:{fontSize:s.sizeLG,color:"#ff4d4f"}})})})]})}));return e.jsxs(re,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:n.textPrimary,fontSize:"18px",fontWeight:600},children:"下载列表"}),e.jsxs(V,{children:[e.jsx(ee,{title:"检查不符合过滤规则的文件",children:e.jsx(oe,{icon:e.jsx(Ce,{}),size:"small",onClick:de,loading:A,style:{background:n.bgContainer,borderColor:n.goldPrimary,color:n.goldPrimary,transition:"all 0.3s ease"},children:"快速检查"})}),e.jsx(oe,{icon:e.jsx(fe,{}),size:"small",onClick:de,loading:A,style:{background:n.bgContainer,borderColor:n.warning,color:n.warning,transition:"all 0.3s ease"},children:"批量清理"}),e.jsxs(oe,{icon:e.jsx(fn,{}),size:"small",onClick:()=>I(!c),style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textSecondary,transition:"all 0.3s ease"},children:["高级筛选 ",c?"▼":"▶"]}),e.jsx(oe,{icon:e.jsx(mn,{}),size:"small",onClick:Q,loading:G,style:{background:"linear-gradient(135deg, #d4a852 0%, #e8c780 100%)",borderColor:n.goldPrimary,color:n.bgBase,fontWeight:600,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:"刷新"})]})]}),loading:G,extra:e.jsxs(V.Compact,{children:[e.jsx(pn,{value:x,onChange:o=>v(o.target.value),placeholder:"搜索",style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textPrimary}}),e.jsx(oe,{icon:e.jsx(Ce,{}),style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textSecondary}})]}),style:{background:n.bgElevated,borderColor:n.borderPrimary},styles:{header:{background:n.bgBase,borderBottom:"1px solid rgba(255, 255, 255, 0.08)"},body:{background:n.bgElevated}},children:[e.jsxs(le,{gutter:16,style:{marginBottom:20},children:[e.jsx(W,{span:6,children:e.jsx(re,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(ne,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"总任务数"}),value:L.length,valueStyle:{color:n.textPrimary,fontSize:"24px",fontWeight:600}})})}),e.jsx(W,{span:6,children:e.jsx(re,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(ne,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"进行中"}),value:L.reduce((o,a)=>o+a.files.filter(S=>S.progress>0&&S.progress<1).length,0),valueStyle:{color:"#4facfe",fontSize:"24px",fontWeight:600}})})}),e.jsx(W,{span:6,children:e.jsx(re,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(ne,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"已完成"}),value:L.reduce((o,a)=>o+a.files.filter(S=>S.progress>=1).length,0),valueStyle:{color:"#52c41a",fontSize:"24px",fontWeight:600}})})}),e.jsx(W,{span:6,children:e.jsx(re,{size:"small",style:{background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px"}},children:e.jsx(ne,{title:e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"失败/等待"}),value:L.reduce((o,a)=>o+a.files.filter(S=>S.progress===0).length,0),valueStyle:{color:"#ff7875",fontSize:"24px",fontWeight:600}})})})]}),e.jsx(xn,{}),e.jsx("div",{style:{marginBottom:16,padding:"12px 16px",background:n.bgContainer,border:"1px solid rgba(255, 255, 255, 0.08)",borderRadius:"8px"},children:e.jsxs(le,{gutter:16,children:[e.jsx(W,{children:e.jsxs(V,{children:[e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"显示已完成:"}),e.jsx(ye,{checked:C,onChange:$,size:"small",style:{background:C?n.goldPrimary:"rgba(255, 255, 255, 0.2)"}})]})}),e.jsx(W,{children:e.jsxs(V,{children:[e.jsx("span",{style:{color:n.textSecondary,fontSize:"14px"},children:"显示失败:"}),e.jsx(ye,{checked:h,onChange:i,size:"small",style:{background:h?n.goldPrimary:"rgba(255, 255, 255, 0.2)"}})]})})]})}),c&&e.jsx(re,{size:"small",style:{marginBottom:16,background:n.bgContainer,borderColor:n.borderPrimary,borderRadius:"8px"},styles:{body:{padding:"16px",background:n.bgContainer}},children:e.jsxs(le,{gutter:[16,8],children:[e.jsxs(W,{span:8,children:[e.jsx("div",{style:{marginBottom:8,color:n.textSecondary,fontSize:"14px",fontWeight:500},children:"状态筛选"}),e.jsxs(D,{value:g.status,onChange:o=>b({...g,status:o}),style:{width:"100%"},dropdownStyle:{background:n.bgContainer,borderColor:n.borderPrimary},children:[e.jsx(D.Option,{value:"all",children:"全部状态"}),e.jsx(D.Option,{value:"downloading",children:"下载中"}),e.jsx(D.Option,{value:"completed",children:"已完成"}),e.jsx(D.Option,{value:"failed",children:"失败/等待"})]})]}),e.jsxs(W,{span:8,children:[e.jsx("div",{style:{marginBottom:8,color:n.textSecondary,fontSize:"14px",fontWeight:500},children:"排序方式"}),e.jsxs(D,{value:`${g.sortBy}-${g.sortOrder}`,onChange:o=>{const[a,S]=o.split("-");b({...g,sortBy:a,sortOrder:S})},style:{width:"100%"},dropdownStyle:{background:n.bgContainer,borderColor:n.borderPrimary},children:[e.jsx(D.Option,{value:"date-desc",children:"添加时间 (新→旧)"}),e.jsx(D.Option,{value:"date-asc",children:"添加时间 (旧→新)"}),e.jsx(D.Option,{value:"progress-desc",children:"进度 (高→低)"}),e.jsx(D.Option,{value:"progress-asc",children:"进度 (低→高)"}),e.jsx(D.Option,{value:"size-desc",children:"大小 (大→小)"}),e.jsx(D.Option,{value:"size-asc",children:"大小 (小→大)"})]})]}),e.jsxs(W,{span:8,children:[e.jsx("div",{style:{marginBottom:8,color:n.textSecondary,fontSize:"14px",fontWeight:500},children:"快速操作"}),e.jsx(V,{children:e.jsx(oe,{size:"small",onClick:()=>{b({status:"all",sizeRange:[0,1e4],dateRange:null,sortBy:"date",sortOrder:"desc"}),v("")},style:{background:n.bgContainer,borderColor:n.borderPrimary,color:n.textSecondary},children:"重置筛选"})})]})]})}),Z.length>0?e.jsxs(e.Fragment,{children:[Z.length!==L.length&&e.jsx("div",{style:{marginBottom:16,padding:"12px 16px",background:n.bgContainer,border:"1px solid rgba(255, 255, 255, 0.08)",borderRadius:8},children:e.jsxs(V,{children:[e.jsx(be,{count:Z.length,style:{background:"linear-gradient(135deg, #d4a852 0%, #e8c780 100%)",color:n.bgBase,fontWeight:600,boxShadow:"0 2px 8px rgba(212, 168, 82, 0.3)"}}),e.jsxs("span",{style:{color:n.textSecondary,fontSize:"14px"},children:["筛选结果：",Z.length," / ",L.length," 个任务"]})]})}),e.jsx(Kn,{items:Ae,ghost:!0})]}):L.length>0?e.jsx(ie,{description:"没有符合筛选条件的下载任务"}):e.jsx(ie,{description:e.jsxs("span",{children:["无下载任务，",e.jsx(hn,{to:"/setting/download",children:"配置下载"})]})}),e.jsx(Cn,{title:"下载整理",mode:"download",width:1100,path:m,open:!!m,onCancel:()=>u(void 0),onOk:()=>{u(void 0),Q()}}),e.jsx(ve,{title:"清理文件预览",open:l,onOk:Be,onCancel:Ne,okText:"确认清理",cancelText:"取消",okButtonProps:{danger:!0,loading:O},width:800,styles:{body:{background:n.bgBase,maxHeight:"500px",overflowY:"auto"}},children:j&&e.jsxs("div",{style:{color:n.textPrimary},children:[e.jsx("div",{style:{marginBottom:16,padding:"12px 16px",background:n.bgContainer,borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:e.jsxs(le,{gutter:16,children:[e.jsxs(W,{span:12,children:[e.jsx("span",{style:{color:n.textSecondary},children:"将要删除的文件数："}),e.jsx("span",{style:{color:"#ff4d4f",fontWeight:600,marginLeft:8},children:((ge=j.files_to_delete)==null?void 0:ge.length)||0})]}),e.jsxs(W,{span:12,children:[e.jsx("span",{style:{color:n.textSecondary},children:"预计释放空间："}),e.jsx("span",{style:{color:"#52c41a",fontWeight:600,marginLeft:8},children:j.total_size||"0 MB"})]})]})}),j.files_to_delete&&j.files_to_delete.length>0?e.jsx(q,{dataSource:j.files_to_delete,renderItem:o=>e.jsx(q.Item,{style:{background:n.bgElevated,borderRadius:"8px",padding:"12px 16px",marginBottom:"8px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:e.jsx(q.Item.Meta,{title:e.jsx("span",{style:{color:n.textPrimary},children:o.name}),description:e.jsxs("div",{children:[e.jsx("div",{style:{color:n.textTertiary,fontSize:"13px"},children:o.path}),e.jsxs(V,{style:{marginTop:4},children:[e.jsx(se,{style:{background:"rgba(255, 77, 79, 0.2)",borderColor:"#ff4d4f",color:"#ff4d4f"},children:o.size}),o.reason&&e.jsx(se,{style:{background:"rgba(250, 173, 20, 0.2)",borderColor:n.warning,color:n.warning},children:o.reason})]})]})})})}):e.jsx(ie,{description:"没有需要清理的文件",style:{color:n.textSecondary}})]})}),e.jsx(ve,{title:"不符合过滤规则的文件预览",open:Y,onOk:_e,onCancel:Me,okText:"确认清理",cancelText:"取消",okButtonProps:{danger:!0,loading:A},width:900,styles:{body:{background:n.bgBase,maxHeight:"600px",overflowY:"auto"}},children:H&&e.jsxs("div",{style:{color:n.textPrimary},children:[e.jsx("div",{style:{marginBottom:16,padding:"16px",background:n.bgContainer,borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:e.jsxs(le,{gutter:16,children:[e.jsx(W,{span:8,children:e.jsx(ne,{title:e.jsx("span",{style:{color:n.textSecondary},children:"将要清理的种子数"}),value:H.processed_torrents||0,valueStyle:{color:n.goldPrimary,fontWeight:600}})}),e.jsx(W,{span:8,children:e.jsx(ne,{title:e.jsx("span",{style:{color:n.textSecondary},children:"总共要删除的文件数"}),value:H.total_deleted_files||0,valueStyle:{color:"#ff4d4f",fontWeight:600}})}),e.jsx(W,{span:8,children:e.jsx(ne,{title:e.jsx("span",{style:{color:n.textSecondary},children:"预计释放空间"}),value:(H.total_deleted_size_mb||0)/1024,precision:2,suffix:"GB",valueStyle:{color:"#52c41a",fontWeight:600}})})]})}),H.torrent_results&&H.torrent_results.length>0?e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:12,color:n.textSecondary,fontSize:"14px",fontWeight:500},children:"详细清理列表："}),e.jsx(q,{dataSource:H.torrent_results,renderItem:(o,a)=>{var S;return e.jsx(q.Item,{style:{background:n.bgElevated,borderRadius:"8px",padding:"12px 16px",marginBottom:"8px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:e.jsxs("div",{style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[e.jsx(be,{count:a+1,style:{background:n.goldPrimary,marginRight:8}}),e.jsx("span",{style:{color:n.textPrimary,fontWeight:500,fontSize:"14px"},children:o.torrent_name||"未知种子"}),e.jsxs(se,{style:{marginLeft:"auto",background:"rgba(255, 77, 79, 0.2)",borderColor:"#ff4d4f",color:"#ff4d4f"},children:[((S=o.files_removed)==null?void 0:S.length)||0," 个文件"]})]}),o.files_removed&&o.files_removed.length>0&&e.jsx("div",{style:{paddingLeft:32,color:n.textTertiary,fontSize:"13px"},children:o.files_removed.map((p,K)=>e.jsx("div",{style:{padding:"4px 0",borderBottom:K<o.files_removed.length-1?"1px solid rgba(255, 255, 255, 0.05)":"none"},children:p},K))})]})})}})]}):e.jsx(ie,{description:"没有需要批量清理的文件",style:{color:n.textSecondary}})]})})]})}export{Yn as component};
