# 智能下载过滤功能 - 用户使用指南

## 功能入口
- **访问路径**: 设置 → 下载过滤
- **URL**: `/setting/download-filter`
- **权限要求**: 需要登录认证

## 主要配置选项

### 🎯 文件大小控制
```
最小文件大小: 300MB (推荐)
- 用途: 过滤掉小的样本文件、字幕文件等
- 建议: 根据需求调整，300MB适合大多数视频

最大文件大小: 无限制 (可选)
- 用途: 避免下载超大文件占用过多空间
- 建议: 可设置5GB或10GB作为上限
```

### 🎬 媒体文件模式 (重点功能)
```
只保留媒体文件: 开启/关闭
- 开启: 只保留视频文件和字幕文件
- 关闭: 使用传统的视频文件模式
- 推荐: 对于影视内容建议开启

包含字幕文件: 开启/关闭
- 开启: 在媒体模式下保留字幕文件
- 关闭: 在媒体模式下只要视频文件
- 推荐: 开启，以获得完整观看体验
```

### 🧠 智能过滤选项
```
启用智能过滤: 建议开启
- 自动识别样本文件、宣传文件等
- 基于文件名关键词智能判断

跳过样本文件: 建议开启  
- 自动过滤sample、preview等文件
- 节省带宽和存储空间

跳过纯字幕文件: 根据需求
- 在非媒体模式下是否跳过字幕
- 媒体模式下此选项无效
```

## 使用场景推荐

### 场景1: 只要主要视频内容
```
配置:
- 最小文件大小: 300MB
- 媒体文件模式: 关闭
- 智能过滤: 开启
- 跳过样本文件: 开启

适用: 只需要主要视频，不要字幕和其他文件
结果: 通常只保留1个主要视频文件
```

### 场景2: 完整媒体内容 (推荐)
```
配置:
- 最小文件大小: 10MB
- 媒体文件模式: 开启
- 包含字幕文件: 开启
- 智能过滤: 开启

适用: 需要视频+字幕的完整观看体验
结果: 保留主视频和所有字幕文件
```

### 场景3: 严格空间控制
```
配置:
- 最小文件大小: 1GB
- 最大文件大小: 5GB
- 媒体文件模式: 开启
- 智能过滤: 开启

适用: 存储空间有限，只要高质量内容
结果: 只保留大文件的主要内容
```

## 实时测试功能

### 测试流程
1. **点击"测试过滤"按钮**
2. **输入磁力链接**: 粘贴完整的magnet链接
3. **查看预览结果**: 
   - 原始文件数量和大小
   - 过滤后文件数量和大小
   - 具体保留/过滤的文件列表
   - 过滤原因说明

### 测试示例
```
输入: magnet:?xt=urn:btih:c99761251c62a1b49b86b9dfdc0aeb84ca75c9b4...

结果显示:
- 原始文件: 7个文件, 6.49GB
- 过滤后: 1个文件, 6.42GB  
- 节省空间: 0.06GB (1.0%)
- 保留文件: MIDV-751-UC.mp4 (6.42GB)
```

## 注意事项

### ⚠️ 重要提醒
1. **设置生效**: 新设置只对后续添加的种子生效
2. **已有种子**: 需要手动对已存在种子应用过滤
3. **网络依赖**: 测试功能需要qBittorrent连接正常
4. **备份建议**: 重要文件建议先备份再测试

### 💡 使用技巧
1. **先测试**: 添加种子前先用测试功能预览效果
2. **分类设置**: 不同类型内容可使用不同配置
3. **定期调整**: 根据使用情况调整文件大小阈值
4. **观察日志**: 查看过滤日志了解详细过程

## 故障排除

### 常见问题
1. **测试失败**: 检查qBittorrent连接状态
2. **过滤不生效**: 确认设置已保存且种子是新添加的
3. **文件被误过滤**: 调整文件大小阈值或关闭相关过滤
4. **字幕文件丢失**: 开启媒体文件模式并包含字幕

### 恢复方法
1. **重置设置**: 点击"重置为默认"按钮
2. **手动调整**: 逐个检查和修改配置选项
3. **查看日志**: 从应用日志中查看过滤详情